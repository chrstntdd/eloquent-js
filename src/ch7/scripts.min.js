/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(1);
	__webpack_require__(2);

/***/ },
/* 1 */
/***/ function(module, exports) {

	// test: no
	
	(function() {
	  "use strict";
	
	  var active = null;
	
	  function Animated(world) {
	    this.world = world;
	    var outer = (window.__sandbox ? window.__sandbox.output.div : document.body), doc = outer.ownerDocument;
	    var node = outer.appendChild(doc.createElement("div"));
	    node.style.cssText = "position: relative; width: intrinsic; width: fit-content;";
	    this.pre = node.appendChild(doc.createElement("pre"));
	    this.pre.appendChild(doc.createTextNode(world.toString()));
	    this.button = node.appendChild(doc.createElement("div"));
	    this.button.style.cssText = "position: absolute; bottom: 8px; right: -4.5em; color: white; font-family: tahoma, arial; " +
	      "background: #4ab; cursor: pointer; border-radius: 18px; font-size: 70%; width: 3.5em; text-align: center;";
	    this.button.innerHTML = "stop";
	    var self = this;
	    this.button.addEventListener("click", function() { self.clicked(); });
	    this.disabled = false;
	    if (active) active.disable();
	    active = this;
	    this.interval = setInterval(function() { self.tick(); }, 333);
	  }
	
	  Animated.prototype.clicked = function() {
	    if (this.disabled) return;
	    if (this.interval) {
	      clearInterval(this.interval);
	      this.interval = null;
	      this.button.innerHTML = "start";
	    } else {
	      var self = this;
	      this.interval = setInterval(function() { self.tick(); }, 333);
	      this.button.innerHTML = "stop";
	    }
	  };
	
	  Animated.prototype.tick = function() {
	    this.world.turn();
	    this.pre.removeChild(this.pre.firstChild);
	    this.pre.appendChild(this.pre.ownerDocument.createTextNode(this.world.toString()));
	  };
	
	  Animated.prototype.disable = function() {
	    this.disabled = true;
	    clearInterval(this.interval);
	    this.button.innerHTML = "Disabled";
	    this.button.style.color = "red";
	  };
	
	  window.animateWorld = function(world) { new Animated(world); };
	})();

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	var __extends = (this && this.__extends) || function (d, b) {
	    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
	    function __() { this.constructor = d; }
	    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
	};
	var ch6_ex_1 = __webpack_require__(3);
	var directions = {
	    'n': new ch6_ex_1.Vector(0, 1),
	    'ne': new ch6_ex_1.Vector(1, -1),
	    'e': new ch6_ex_1.Vector(1, 0),
	    'se': new ch6_ex_1.Vector(0, -1),
	    's': new ch6_ex_1.Vector(0, 1),
	    'sw': new ch6_ex_1.Vector(-1, 1),
	    'w': new ch6_ex_1.Vector(-1, 0),
	    'nw': new ch6_ex_1.Vector(-1, -1)
	};
	var plan = ["############################",
	    "#      #    #      o      ##",
	    "#                          #",
	    "#          #####           #",
	    "##         #~  #    ##     #",
	    "###           ##     #     #",
	    "#           ###      #     #",
	    "#   ####                   #",
	    "#   ##       o             #",
	    "# o  #         o       ### #",
	    "#    #~                    #",
	    "############################"];
	var directionNames = 'n ne e se s sw w nw'.split(' ');
	function randomElement(array) {
	    return array[Math.floor(Math.random() * array.length)];
	}
	var Grid = (function () {
	    function Grid(width, height) {
	        this.space = new Array(width * height);
	        this.width = width;
	        this.height = height;
	    }
	    Grid.prototype.isInside = function (vector) {
	        return vector.x >= 0 && vector.x < this.width &&
	            vector.y >= 0 && vector.y < this.height;
	    };
	    Grid.prototype.get = function (vector) {
	        return this.space[vector.x + this.width * vector.y];
	    };
	    Grid.prototype.set = function (vector, value) {
	        this.space[vector.x + this.width * vector.y] = value;
	    };
	    Grid.prototype.forEach = function (f, context) {
	        for (var y = 0; y < this.height; y++) {
	            for (var x = 0; x < this.width; x++) {
	                var value = this.space[x + y * this.width];
	                if (value != null) {
	                    f.call(context, value, new ch6_ex_1.Vector(x, y));
	                }
	            }
	        }
	    };
	    return Grid;
	}());
	//var grid = new Grid(5,5);
	//console.log(grid.get(new Vector(1,1)));
	// → undefined
	//grid.set(new Vector(1, 1), "X");
	//console.log(grid.get(new Vector(1, 1)));
	// → X
	function elementFromChar(legend, ch) {
	    if (ch == ' ') {
	        return null;
	    }
	    var element = new legend[ch]();
	    element.originChar = ch;
	    return element;
	}
	function charFromElement(element) {
	    if (element == null) {
	        return ' ';
	    }
	    else {
	        return element.originChar;
	    }
	}
	function Wall() { }
	;
	var BouncingCritter = (function () {
	    function BouncingCritter(direction) {
	        this.direction = randomElement(directionNames);
	    }
	    BouncingCritter.prototype.act = function (view) {
	        if (view.look(this.direction) != ' ') {
	            this.direction = view.find(' ') || 's';
	        }
	        return { type: 'move', direction: this.direction };
	    };
	    return BouncingCritter;
	}());
	var World = (function () {
	    function World(map, legend) {
	        var grid = new Grid(map[0].length, map.length);
	        this.grid = grid;
	        this.legend = legend;
	        this.map = map.forEach(function (line, y) {
	            for (var x = 0; x < line.length; x++)
	                grid.set(new ch6_ex_1.Vector(x, y), elementFromChar(legend, line[x]));
	        });
	    }
	    ;
	    World.prototype.toString = function () {
	        var output = '';
	        for (var y = 0; y < this.grid.height; y++) {
	            for (var x = 0; x < this.grid.width; x++) {
	                var element = this.grid.get(new ch6_ex_1.Vector(x, y));
	                output += charFromElement(element);
	            }
	            output += '\n';
	        }
	        return output;
	    };
	    ;
	    World.prototype.turn = function () {
	        var acted = [];
	        this.grid.forEach(function (critter, vector) {
	            if (critter.act && acted.indexOf(critter) == -1) {
	                acted.push(critter);
	                this.letAct(critter, vector);
	            }
	        }, this);
	    };
	    ;
	    World.prototype.letAct = function (critter, vector) {
	        var action = critter.act(new View(this, vector));
	        if (action && action.type == 'move') {
	            var dest = this.checkDestination(action, vector);
	            if (dest && this.grid.get(dest) == null) {
	                this.grid.set(vector, null);
	                this.grid.set(dest, critter);
	            }
	        }
	    };
	    ;
	    World.prototype.checkDestination = function (action, vector) {
	        if (directions.hasOwnProperty(action.direction)) {
	            var dest = vector.plus(directions[action.direction]);
	            if (this.grid.isInside(dest)) {
	                return dest;
	            }
	        }
	    };
	    ;
	    return World;
	}());
	var View = (function () {
	    function View(world, vector) {
	        this.world = world;
	        this.vector = vector;
	    }
	    View.prototype.look = function (dir) {
	        var target = this.vector.plus(directions[dir]);
	        if (this.world.grid.isInside(target)) {
	            return charFromElement(this.world.grid.get(target));
	        }
	        else {
	            return '#';
	        }
	    };
	    ;
	    View.prototype.findAll = function (ch) {
	        var found = [];
	        for (var dir in directions) {
	            if (this.look(dir) == ch) {
	                found.push(dir);
	            }
	            return found;
	        }
	    };
	    ;
	    View.prototype.find = function (ch) {
	        var found = this.findAll(ch);
	        if (found.length == 0) {
	            return null;
	        }
	        return randomElement(found);
	    };
	    ;
	    return View;
	}());
	function dirPlus(dir, n) {
	    var index = directionNames.indexOf(dir);
	    return directionNames[(index + n + 8) % 8];
	}
	var WallFlower = (function () {
	    function WallFlower(dir) {
	        this.dir = 's';
	    }
	    ;
	    WallFlower.prototype.act = function (view) {
	        var start = this.dir;
	        if (view.look(dirPlus(this.dir, -3)) != ' ') {
	            start = this.dir = dirPlus(this.dir, -2);
	        }
	        while (view.look(this.dir) != ' ') {
	            this.dir = dirPlus(this.dir, 1);
	            if (this.dir == start) {
	                break;
	            }
	        }
	        return { type: 'move', direction: this.dir };
	    };
	    ;
	    return WallFlower;
	}());
	//initalize world.
	//var world = new World(plan, {'#': Wall,
	//                             'o': BouncingCritter,
	//                             '~': WallFlower});
	var LifelikeWorld = (function (_super) {
	    __extends(LifelikeWorld, _super);
	    function LifelikeWorld(map, legend) {
	        _super.call(this, map, legend);
	        World.call(this, map, legend);
	        Object.create(World);
	    }
	    LifelikeWorld.prototype.letAct = function (critter, vector) {
	        var action = critter.act(new View(this, vector));
	        var handled = action && actionTypes[action.type].call(this, critter, vector, action);
	        if (!handled) {
	            critter.energy -= 0.2;
	            if (critter.energy <= 0) {
	                this.grid.set(vector, null);
	            }
	        }
	    };
	    return LifelikeWorld;
	}(World));
	var actionTypes = Object.create(null);
	actionTypes.grow = function (critter) {
	    critter.energy += 0.5;
	    return true;
	};
	actionTypes.move = function (critter, vector, action) {
	    var dest = this.checkDestination(action, vector);
	    if (dest == null || critter.energy <= 1 || this.grid.get(dest) != null) {
	        return false;
	    }
	    critter.energy -= 1;
	    this.grid.set(vector, null);
	    this.grid.set(dest, critter);
	    return true;
	};
	actionTypes.eat = function (critter, vector, action) {
	    var dest = this.checkDestination(action, vector);
	    var atDest = dest != null && this.grid.get(dest);
	    if (!atDest || atDest.energy == null) {
	        return false;
	    }
	    critter.energy += atDest.energy;
	    this.grid.set(dest, null);
	    return true;
	};
	actionTypes.reproduce = function (critter, vector, action) {
	    var baby = elementFromChar(this.legend, critter.originChar);
	    var dest = this.checkDestination(action, vector);
	    if (dest == null || critter.energy <= 2 * baby.energy || this.grid.get(dest) != null) {
	        return false;
	    }
	    critter.energy -= 2 * baby.energy;
	    this.grid.set(dest, baby);
	    return true;
	};
	var Plant = (function () {
	    function Plant(energy) {
	        this.energy = 3 + Math.random() * 4;
	    }
	    Plant.prototype.act = function (view) {
	        if (this.energy > 15) {
	            var space = view.find(" ");
	            if (space)
	                return {
	                    type: "reproduce",
	                    direction: space
	                };
	        }
	        if (this.energy < 20)
	            return {
	                type: "grow",
	                direction: undefined
	            };
	    };
	    return Plant;
	}());
	var PlantEater = (function () {
	    function PlantEater(energy) {
	        this.energy = 20;
	    }
	    PlantEater.prototype.act = function (view) {
	        var space = view.find(' ');
	        if (this.energy > 60 && space) {
	            return {
	                type: 'reproduce',
	                direction: space
	            };
	        }
	        var plant = view.find('*');
	        if (plant) {
	            return {
	                type: 'eat',
	                direction: plant
	            };
	        }
	        if (space) {
	            return {
	                type: 'move',
	                direction: space
	            };
	        }
	    };
	    return PlantEater;
	}());
	var valley = new LifelikeWorld(["############################",
	                                "#####                 ######",
	                                "##   ***                **##",
	                                "#   *##**         **  O  *##",
	                                "#    ***     O    ##**    *#",
	                                "#       O         ##***    #",
	                                "#                 ##**     #",
	                                "#   O       #*             #",
	                                "#*          #**       O    #",
	                                "#***        ##**    O    **#",
	                                "##****     ###***       *###",
	                                "############################"], 
	                                { "#": Wall,
	                                "O":   PlantEater,
	                                "*":   Plant });
	//print 10 turns of life.
	for (var i = 0; i < 10; i++) {
	    valley.turn();
	    console.log(valley.toString());
	}


/***/ },
/* 3 */
/***/ function(module, exports) {

	"use strict";
	var __extends = (this && this.__extends) || function (d, b) {
	    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
	    function __() { this.constructor = d; }
	    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
	};
	//PROBLEM 1 /////////////////////////////////////////////////////////////////////////////
	var Vector = (function () {
	    function Vector(x, y) {
	        this.x = x;
	        this.y = y;
	    }
	    Vector.prototype.plus = function (alt) {
	        return new Vector(this.x + alt.x, this.y + alt.y);
	    };
	    Vector.prototype.minus = function (alt) {
	        return new Vector(this.x - alt.x, this.y - alt.y);
	    };
	    Object.defineProperty(Vector.prototype, "length", {
	        get: function () {
	            return Math.sqrt((this.x * this.x) + (this.y * this.y));
	        },
	        enumerable: true,
	        configurable: true
	    });
	    return Vector;
	}());
	exports.Vector = Vector;
	//console.log(new Vector(1, 2).plus(new Vector(2, 3)));
	// → Vector{x: 3, y: 5}
	//console.log(new Vector(1, 2).minus(new Vector(2, 3)));
	// → Vector{x: -1, y: -1}
	//console.log(new Vector(3, 4).length);
	// → 5
	//PROBLEM 2 /////////////////////////////////////////////////////////////////////////////
	//from textbook.
	function repeat(string, times) {
	    var result = '';
	    for (var i = 0; i < times; i++)
	        result += string;
	    return result;
	}
	//inferred from textbook.
	//minWidth and minHeight methods have been altered from original code.
	var TextCell = (function () {
	    function TextCell(text) {
	        this.text = text.split('');
	    }
	    TextCell.prototype.minWidth = function () {
	        return this.text.length;
	    };
	    TextCell.prototype.minHeight = function () {
	        return 1;
	    };
	    TextCell.prototype.draw = function (width, height) {
	        var result = [];
	        for (var i = 0; i < height; i++) {
	            var line = this.text[i] || '';
	            result.push(line + repeat(' ', width - line.length));
	        }
	        return result;
	    };
	    return TextCell;
	}());
	var StretchCell = (function (_super) {
	    __extends(StretchCell, _super);
	    function StretchCell(text, width, height) {
	        _super.call(this, text);
	        this.width = width;
	        this.height = height;
	    }
	    StretchCell.prototype.minWidth = function () {
	        return Math.max(this.width, _super.prototype.minWidth.call(this));
	    };
	    StretchCell.prototype.minHeight = function () {
	        return Math.max(this.height, _super.prototype.minHeight.call(this));
	    };
	    StretchCell.prototype.draw = function (width, height) {
	        return _super.prototype.draw.call(this, this.width, this.height);
	    };
	    return StretchCell;
	}(TextCell));
	var sc = new StretchCell('abc', 1, 2);
	//console.log(sc.minWidth());
	// → 3
	//console.log(sc.minHeight());
	// → 2
	//console.log(sc.draw(3, 2));
	// draw method inherited from text. Output doesn't pass test. ¯\_(ツ)_/¯ 
	// → ['abc', '   ']
	//PROBLEM 3 /////////////////////////////////////////////////////////////////////////////
	function logFive(seq) {
	    for (var i = 0; i < 5; i++) {
	        if (!seq.next()) {
	            break;
	        }
	        console.log(seq.current());
	    }
	}
	var ArraySeq = (function () {
	    function ArraySeq(array) {
	        this.pos = -1;
	        this.array = array;
	    }
	    ArraySeq.prototype.next = function () {
	        if (this.pos >= this.array.length - 1) {
	            return false;
	        }
	        this.pos++;
	        return true;
	    };
	    ArraySeq.prototype.current = function () {
	        return this.array[this.pos];
	    };
	    return ArraySeq;
	}());
	//using start and end instead of from and to arguments.
	var RangeSeq = (function () {
	    function RangeSeq(start, end) {
	        this.pos = start - 1;
	        this.end = end;
	    }
	    RangeSeq.prototype.next = function () {
	        if (this.pos >= this.end) {
	            return false;
	        }
	        this.pos++;
	        return true;
	    };
	    RangeSeq.prototype.current = function () {
	        return this.pos;
	    };
	    return RangeSeq;
	}());
	//logFive(new ArraySeq([1, 2]));
	// → 1
	// → 2
	//logFive(new RangeSeq(100, 1000));
	// → 100
	// → 101
	// → 102
	// → 103
	// → 104


/***/ }
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgZjMwNzRiYmQ2NDNkYzhmODFiMmUiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NoNy9zY3JpcHRzLmpzIiwid2VicGFjazovLy8uL3NyYy9jaDcvYW5pbWF0ZXdvcmxkLmpzIiwid2VicGFjazovLy8uL3NyYy9jaDcvY2g3LXByb2ouanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NoNi9jaDYtZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7QUN0Q0E7QUFDQSx3Qjs7Ozs7O0FDREE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxrQkFBa0Isb0JBQW9CO0FBQ25GO0FBQ0E7QUFDQTtBQUNBLHFEQUFvRCxhQUFhLGVBQWUsY0FBYyw0QkFBNEI7QUFDMUgseUJBQXdCLGlCQUFpQixxQkFBcUIsZ0JBQWdCLGNBQWMsb0JBQW9CO0FBQ2hIO0FBQ0E7QUFDQSx1REFBc0QsZ0JBQWdCLEVBQUU7QUFDeEU7QUFDQTtBQUNBO0FBQ0EsNkNBQTRDLGFBQWEsRUFBRTtBQUMzRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSwrQ0FBOEMsYUFBYSxFQUFFO0FBQzdEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwwQ0FBeUMscUJBQXFCO0FBQzlELEVBQUMsSTs7Ozs7O0FDckREO0FBQ0E7QUFDQTtBQUNBLG9CQUFtQixzQkFBc0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBdUIsaUJBQWlCO0FBQ3hDLDRCQUEyQixnQkFBZ0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBZ0I7QUFDaEI7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBMkIsaUJBQWlCO0FBQzVDO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXVCLHNCQUFzQjtBQUM3Qyw0QkFBMkIscUJBQXFCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0EsZ0NBQStCO0FBQy9CO0FBQ0EsZ0RBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWlDO0FBQ2pDO0FBQ0EsK0NBQThDO0FBQzlDO0FBQ0EsZ0JBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7Ozs7Ozs7QUNsVkE7QUFDQTtBQUNBO0FBQ0Esb0JBQW1CLHNCQUFzQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBLGFBQVk7QUFDWjtBQUNBLGFBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBbUIsV0FBVztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXVCLFlBQVk7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGYzMDc0YmJkNjQzZGM4ZjgxYjJlIiwicmVxdWlyZSgnLi9hbmltYXRld29ybGQuanMnKTtcbnJlcXVpcmUoJy4vY2g3LXByb2ouanMnKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9jaDcvc2NyaXB0cy5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyB0ZXN0OiBub1xuXG4oZnVuY3Rpb24oKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBhY3RpdmUgPSBudWxsO1xuXG4gIGZ1bmN0aW9uIEFuaW1hdGVkKHdvcmxkKSB7XG4gICAgdGhpcy53b3JsZCA9IHdvcmxkO1xuICAgIHZhciBvdXRlciA9ICh3aW5kb3cuX19zYW5kYm94ID8gd2luZG93Ll9fc2FuZGJveC5vdXRwdXQuZGl2IDogZG9jdW1lbnQuYm9keSksIGRvYyA9IG91dGVyLm93bmVyRG9jdW1lbnQ7XG4gICAgdmFyIG5vZGUgPSBvdXRlci5hcHBlbmRDaGlsZChkb2MuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7XG4gICAgbm9kZS5zdHlsZS5jc3NUZXh0ID0gXCJwb3NpdGlvbjogcmVsYXRpdmU7IHdpZHRoOiBpbnRyaW5zaWM7IHdpZHRoOiBmaXQtY29udGVudDtcIjtcbiAgICB0aGlzLnByZSA9IG5vZGUuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZUVsZW1lbnQoXCJwcmVcIikpO1xuICAgIHRoaXMucHJlLmFwcGVuZENoaWxkKGRvYy5jcmVhdGVUZXh0Tm9kZSh3b3JsZC50b1N0cmluZygpKSk7XG4gICAgdGhpcy5idXR0b24gPSBub2RlLmFwcGVuZENoaWxkKGRvYy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtcbiAgICB0aGlzLmJ1dHRvbi5zdHlsZS5jc3NUZXh0ID0gXCJwb3NpdGlvbjogYWJzb2x1dGU7IGJvdHRvbTogOHB4OyByaWdodDogLTQuNWVtOyBjb2xvcjogd2hpdGU7IGZvbnQtZmFtaWx5OiB0YWhvbWEsIGFyaWFsOyBcIiArXG4gICAgICBcImJhY2tncm91bmQ6ICM0YWI7IGN1cnNvcjogcG9pbnRlcjsgYm9yZGVyLXJhZGl1czogMThweDsgZm9udC1zaXplOiA3MCU7IHdpZHRoOiAzLjVlbTsgdGV4dC1hbGlnbjogY2VudGVyO1wiO1xuICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9IFwic3RvcFwiO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7IHNlbGYuY2xpY2tlZCgpOyB9KTtcbiAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gICAgaWYgKGFjdGl2ZSkgYWN0aXZlLmRpc2FibGUoKTtcbiAgICBhY3RpdmUgPSB0aGlzO1xuICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsgc2VsZi50aWNrKCk7IH0sIDMzMyk7XG4gIH1cblxuICBBbmltYXRlZC5wcm90b3R5cGUuY2xpY2tlZCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmRpc2FibGVkKSByZXR1cm47XG4gICAgaWYgKHRoaXMuaW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XG4gICAgICB0aGlzLmludGVydmFsID0gbnVsbDtcbiAgICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9IFwic3RhcnRcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgeyBzZWxmLnRpY2soKTsgfSwgMzMzKTtcbiAgICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9IFwic3RvcFwiO1xuICAgIH1cbiAgfTtcblxuICBBbmltYXRlZC5wcm90b3R5cGUudGljayA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMud29ybGQudHVybigpO1xuICAgIHRoaXMucHJlLnJlbW92ZUNoaWxkKHRoaXMucHJlLmZpcnN0Q2hpbGQpO1xuICAgIHRoaXMucHJlLmFwcGVuZENoaWxkKHRoaXMucHJlLm93bmVyRG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy53b3JsZC50b1N0cmluZygpKSk7XG4gIH07XG5cbiAgQW5pbWF0ZWQucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcbiAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuICAgIHRoaXMuYnV0dG9uLmlubmVySFRNTCA9IFwiRGlzYWJsZWRcIjtcbiAgICB0aGlzLmJ1dHRvbi5zdHlsZS5jb2xvciA9IFwicmVkXCI7XG4gIH07XG5cbiAgd2luZG93LmFuaW1hdGVXb3JsZCA9IGZ1bmN0aW9uKHdvcmxkKSB7IG5ldyBBbmltYXRlZCh3b3JsZCk7IH07XG59KSgpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2NoNy9hbmltYXRld29ybGQuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xufTtcbnZhciBjaDZfZXhfMSA9IHJlcXVpcmUoJy4uL2NoNi9jaDYtZXgnKTtcbnZhciBkaXJlY3Rpb25zID0ge1xuICAgICduJzogbmV3IGNoNl9leF8xLlZlY3RvcigwLCAxKSxcbiAgICAnbmUnOiBuZXcgY2g2X2V4XzEuVmVjdG9yKDEsIC0xKSxcbiAgICAnZSc6IG5ldyBjaDZfZXhfMS5WZWN0b3IoMSwgMCksXG4gICAgJ3NlJzogbmV3IGNoNl9leF8xLlZlY3RvcigwLCAtMSksXG4gICAgJ3MnOiBuZXcgY2g2X2V4XzEuVmVjdG9yKDAsIDEpLFxuICAgICdzdyc6IG5ldyBjaDZfZXhfMS5WZWN0b3IoLTEsIDEpLFxuICAgICd3JzogbmV3IGNoNl9leF8xLlZlY3RvcigtMSwgMCksXG4gICAgJ253JzogbmV3IGNoNl9leF8xLlZlY3RvcigtMSwgLTEpXG59O1xudmFyIHBsYW4gPSBbXCIjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXCIsXG4gICAgXCIjICAgICAgIyAgICAjICAgICAgbyAgICAgICMjXCIsXG4gICAgXCIjICAgICAgICAgICAgICAgICAgICAgICAgICAjXCIsXG4gICAgXCIjICAgICAgICAgICMjIyMjICAgICAgICAgICAjXCIsXG4gICAgXCIjIyAgICAgICAgICN+ICAjICAgICMjICAgICAjXCIsXG4gICAgXCIjIyMgICAgICAgICAgICMjICAgICAjICAgICAjXCIsXG4gICAgXCIjICAgICAgICAgICAjIyMgICAgICAjICAgICAjXCIsXG4gICAgXCIjICAgIyMjIyAgICAgICAgICAgICAgICAgICAjXCIsXG4gICAgXCIjICAgIyMgICAgICAgbyAgICAgICAgICAgICAjXCIsXG4gICAgXCIjIG8gICMgICAgICAgICBvICAgICAgICMjIyAjXCIsXG4gICAgXCIjICAgICN+ICAgICAgICAgICAgICAgICAgICAjXCIsXG4gICAgXCIjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXCJdO1xudmFyIGRpcmVjdGlvbk5hbWVzID0gJ24gbmUgZSBzZSBzIHN3IHcgbncnLnNwbGl0KCcgJyk7XG5mdW5jdGlvbiByYW5kb21FbGVtZW50KGFycmF5KSB7XG4gICAgcmV0dXJuIGFycmF5W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFycmF5Lmxlbmd0aCldO1xufVxudmFyIEdyaWQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdyaWQod2lkdGgsIGhlaWdodCkge1xuICAgICAgICB0aGlzLnNwYWNlID0gbmV3IEFycmF5KHdpZHRoICogaGVpZ2h0KTtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICB9XG4gICAgR3JpZC5wcm90b3R5cGUuaXNJbnNpZGUgPSBmdW5jdGlvbiAodmVjdG9yKSB7XG4gICAgICAgIHJldHVybiB2ZWN0b3IueCA+PSAwICYmIHZlY3Rvci54IDwgdGhpcy53aWR0aCAmJlxuICAgICAgICAgICAgdmVjdG9yLnkgPj0gMCAmJiB2ZWN0b3IueSA8IHRoaXMuaGVpZ2h0O1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHZlY3Rvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5zcGFjZVt2ZWN0b3IueCArIHRoaXMud2lkdGggKiB2ZWN0b3IueV07XG4gICAgfTtcbiAgICBHcmlkLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodmVjdG9yLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLnNwYWNlW3ZlY3Rvci54ICsgdGhpcy53aWR0aCAqIHZlY3Rvci55XSA9IHZhbHVlO1xuICAgIH07XG4gICAgR3JpZC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChmLCBjb250ZXh0KSB7XG4gICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgdGhpcy5oZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB0aGlzLndpZHRoOyB4KyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLnNwYWNlW3ggKyB5ICogdGhpcy53aWR0aF07XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZi5jYWxsKGNvbnRleHQsIHZhbHVlLCBuZXcgY2g2X2V4XzEuVmVjdG9yKHgsIHkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBHcmlkO1xufSgpKTtcbi8vdmFyIGdyaWQgPSBuZXcgR3JpZCg1LDUpO1xuLy9jb25zb2xlLmxvZyhncmlkLmdldChuZXcgVmVjdG9yKDEsMSkpKTtcbi8vIOKGkiB1bmRlZmluZWRcbi8vZ3JpZC5zZXQobmV3IFZlY3RvcigxLCAxKSwgXCJYXCIpO1xuLy9jb25zb2xlLmxvZyhncmlkLmdldChuZXcgVmVjdG9yKDEsIDEpKSk7XG4vLyDihpIgWFxuZnVuY3Rpb24gZWxlbWVudEZyb21DaGFyKGxlZ2VuZCwgY2gpIHtcbiAgICBpZiAoY2ggPT0gJyAnKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZWxlbWVudCA9IG5ldyBsZWdlbmRbY2hdKCk7XG4gICAgZWxlbWVudC5vcmlnaW5DaGFyID0gY2g7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59XG5mdW5jdGlvbiBjaGFyRnJvbUVsZW1lbnQoZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50ID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuICcgJztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50Lm9yaWdpbkNoYXI7XG4gICAgfVxufVxuZnVuY3Rpb24gV2FsbCgpIHsgfVxuO1xudmFyIEJvdW5jaW5nQ3JpdHRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQm91bmNpbmdDcml0dGVyKGRpcmVjdGlvbikge1xuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IHJhbmRvbUVsZW1lbnQoZGlyZWN0aW9uTmFtZXMpO1xuICAgIH1cbiAgICBCb3VuY2luZ0NyaXR0ZXIucHJvdG90eXBlLmFjdCA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmICh2aWV3Lmxvb2sodGhpcy5kaXJlY3Rpb24pICE9ICcgJykge1xuICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSB2aWV3LmZpbmQoJyAnKSB8fCAncyc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogJ21vdmUnLCBkaXJlY3Rpb246IHRoaXMuZGlyZWN0aW9uIH07XG4gICAgfTtcbiAgICByZXR1cm4gQm91bmNpbmdDcml0dGVyO1xufSgpKTtcbnZhciBXb3JsZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV29ybGQobWFwLCBsZWdlbmQpIHtcbiAgICAgICAgdmFyIGdyaWQgPSBuZXcgR3JpZChtYXBbMF0ubGVuZ3RoLCBtYXAubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5ncmlkID0gZ3JpZDtcbiAgICAgICAgdGhpcy5sZWdlbmQgPSBsZWdlbmQ7XG4gICAgICAgIHRoaXMubWFwID0gbWFwLmZvckVhY2goZnVuY3Rpb24gKGxpbmUsIHkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgbGluZS5sZW5ndGg7IHgrKylcbiAgICAgICAgICAgICAgICBncmlkLnNldChuZXcgY2g2X2V4XzEuVmVjdG9yKHgsIHkpLCBlbGVtZW50RnJvbUNoYXIobGVnZW5kLCBsaW5lW3hdKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICA7XG4gICAgV29ybGQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3V0cHV0ID0gJyc7XG4gICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgdGhpcy5ncmlkLmhlaWdodDsgeSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHRoaXMuZ3JpZC53aWR0aDsgeCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmdyaWQuZ2V0KG5ldyBjaDZfZXhfMS5WZWN0b3IoeCwgeSkpO1xuICAgICAgICAgICAgICAgIG91dHB1dCArPSBjaGFyRnJvbUVsZW1lbnQoZWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXRwdXQgKz0gJ1xcbic7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xuICAgIDtcbiAgICBXb3JsZC5wcm90b3R5cGUudHVybiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFjdGVkID0gW107XG4gICAgICAgIHRoaXMuZ3JpZC5mb3JFYWNoKGZ1bmN0aW9uIChjcml0dGVyLCB2ZWN0b3IpIHtcbiAgICAgICAgICAgIGlmIChjcml0dGVyLmFjdCAmJiBhY3RlZC5pbmRleE9mKGNyaXR0ZXIpID09IC0xKSB7XG4gICAgICAgICAgICAgICAgYWN0ZWQucHVzaChjcml0dGVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxldEFjdChjcml0dGVyLCB2ZWN0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICB9O1xuICAgIDtcbiAgICBXb3JsZC5wcm90b3R5cGUubGV0QWN0ID0gZnVuY3Rpb24gKGNyaXR0ZXIsIHZlY3Rvcikge1xuICAgICAgICB2YXIgYWN0aW9uID0gY3JpdHRlci5hY3QobmV3IFZpZXcodGhpcywgdmVjdG9yKSk7XG4gICAgICAgIGlmIChhY3Rpb24gJiYgYWN0aW9uLnR5cGUgPT0gJ21vdmUnKSB7XG4gICAgICAgICAgICB2YXIgZGVzdCA9IHRoaXMuY2hlY2tEZXN0aW5hdGlvbihhY3Rpb24sIHZlY3Rvcik7XG4gICAgICAgICAgICBpZiAoZGVzdCAmJiB0aGlzLmdyaWQuZ2V0KGRlc3QpID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyaWQuc2V0KHZlY3RvciwgbnVsbCk7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmlkLnNldChkZXN0LCBjcml0dGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgO1xuICAgIFdvcmxkLnByb3RvdHlwZS5jaGVja0Rlc3RpbmF0aW9uID0gZnVuY3Rpb24gKGFjdGlvbiwgdmVjdG9yKSB7XG4gICAgICAgIGlmIChkaXJlY3Rpb25zLmhhc093blByb3BlcnR5KGFjdGlvbi5kaXJlY3Rpb24pKSB7XG4gICAgICAgICAgICB2YXIgZGVzdCA9IHZlY3Rvci5wbHVzKGRpcmVjdGlvbnNbYWN0aW9uLmRpcmVjdGlvbl0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuZ3JpZC5pc0luc2lkZShkZXN0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkZXN0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICA7XG4gICAgcmV0dXJuIFdvcmxkO1xufSgpKTtcbnZhciBWaWV3ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBWaWV3KHdvcmxkLCB2ZWN0b3IpIHtcbiAgICAgICAgdGhpcy53b3JsZCA9IHdvcmxkO1xuICAgICAgICB0aGlzLnZlY3RvciA9IHZlY3RvcjtcbiAgICB9XG4gICAgVmlldy5wcm90b3R5cGUubG9vayA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudmVjdG9yLnBsdXMoZGlyZWN0aW9uc1tkaXJdKTtcbiAgICAgICAgaWYgKHRoaXMud29ybGQuZ3JpZC5pc0luc2lkZSh0YXJnZXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gY2hhckZyb21FbGVtZW50KHRoaXMud29ybGQuZ3JpZC5nZXQodGFyZ2V0KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJyMnO1xuICAgICAgICB9XG4gICAgfTtcbiAgICA7XG4gICAgVmlldy5wcm90b3R5cGUuZmluZEFsbCA9IGZ1bmN0aW9uIChjaCkge1xuICAgICAgICB2YXIgZm91bmQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgZGlyIGluIGRpcmVjdGlvbnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmxvb2soZGlyKSA9PSBjaCkge1xuICAgICAgICAgICAgICAgIGZvdW5kLnB1c2goZGlyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmb3VuZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgO1xuICAgIFZpZXcucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAoY2gpIHtcbiAgICAgICAgdmFyIGZvdW5kID0gdGhpcy5maW5kQWxsKGNoKTtcbiAgICAgICAgaWYgKGZvdW5kLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmFuZG9tRWxlbWVudChmb3VuZCk7XG4gICAgfTtcbiAgICA7XG4gICAgcmV0dXJuIFZpZXc7XG59KCkpO1xuZnVuY3Rpb24gZGlyUGx1cyhkaXIsIG4pIHtcbiAgICB2YXIgaW5kZXggPSBkaXJlY3Rpb25OYW1lcy5pbmRleE9mKGRpcik7XG4gICAgcmV0dXJuIGRpcmVjdGlvbk5hbWVzWyhpbmRleCArIG4gKyA4KSAlIDhdO1xufVxudmFyIFdhbGxGbG93ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFdhbGxGbG93ZXIoZGlyKSB7XG4gICAgICAgIHRoaXMuZGlyID0gJ3MnO1xuICAgIH1cbiAgICA7XG4gICAgV2FsbEZsb3dlci5wcm90b3R5cGUuYWN0ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5kaXI7XG4gICAgICAgIGlmICh2aWV3Lmxvb2soZGlyUGx1cyh0aGlzLmRpciwgLTMpKSAhPSAnICcpIHtcbiAgICAgICAgICAgIHN0YXJ0ID0gdGhpcy5kaXIgPSBkaXJQbHVzKHRoaXMuZGlyLCAtMik7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHZpZXcubG9vayh0aGlzLmRpcikgIT0gJyAnKSB7XG4gICAgICAgICAgICB0aGlzLmRpciA9IGRpclBsdXModGhpcy5kaXIsIDEpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGlyID09IHN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogJ21vdmUnLCBkaXJlY3Rpb246IHRoaXMuZGlyIH07XG4gICAgfTtcbiAgICA7XG4gICAgcmV0dXJuIFdhbGxGbG93ZXI7XG59KCkpO1xuLy9pbml0YWxpemUgd29ybGQuXG4vL3ZhciB3b3JsZCA9IG5ldyBXb3JsZChwbGFuLCB7JyMnOiBXYWxsLFxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvJzogQm91bmNpbmdDcml0dGVyLFxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICd+JzogV2FsbEZsb3dlcn0pO1xudmFyIExpZmVsaWtlV29ybGQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMaWZlbGlrZVdvcmxkLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExpZmVsaWtlV29ybGQobWFwLCBsZWdlbmQpIHtcbiAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgbWFwLCBsZWdlbmQpO1xuICAgICAgICBXb3JsZC5jYWxsKHRoaXMsIG1hcCwgbGVnZW5kKTtcbiAgICAgICAgT2JqZWN0LmNyZWF0ZShXb3JsZCk7XG4gICAgfVxuICAgIExpZmVsaWtlV29ybGQucHJvdG90eXBlLmxldEFjdCA9IGZ1bmN0aW9uIChjcml0dGVyLCB2ZWN0b3IpIHtcbiAgICAgICAgdmFyIGFjdGlvbiA9IGNyaXR0ZXIuYWN0KG5ldyBWaWV3KHRoaXMsIHZlY3RvcikpO1xuICAgICAgICB2YXIgaGFuZGxlZCA9IGFjdGlvbiAmJiBhY3Rpb25UeXBlc1thY3Rpb24udHlwZV0uY2FsbCh0aGlzLCBjcml0dGVyLCB2ZWN0b3IsIGFjdGlvbik7XG4gICAgICAgIGlmICghaGFuZGxlZCkge1xuICAgICAgICAgICAgY3JpdHRlci5lbmVyZ3kgLT0gMC4yO1xuICAgICAgICAgICAgaWYgKGNyaXR0ZXIuZW5lcmd5IDw9IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdyaWQuc2V0KHZlY3RvciwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBMaWZlbGlrZVdvcmxkO1xufShXb3JsZCkpO1xudmFyIGFjdGlvblR5cGVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbmFjdGlvblR5cGVzLmdyb3cgPSBmdW5jdGlvbiAoY3JpdHRlcikge1xuICAgIGNyaXR0ZXIuZW5lcmd5ICs9IDAuNTtcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5hY3Rpb25UeXBlcy5tb3ZlID0gZnVuY3Rpb24gKGNyaXR0ZXIsIHZlY3RvciwgYWN0aW9uKSB7XG4gICAgdmFyIGRlc3QgPSB0aGlzLmNoZWNrRGVzdGluYXRpb24oYWN0aW9uLCB2ZWN0b3IpO1xuICAgIGlmIChkZXN0ID09IG51bGwgfHwgY3JpdHRlci5lbmVyZ3kgPD0gMSB8fCB0aGlzLmdyaWQuZ2V0KGRlc3QpICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjcml0dGVyLmVuZXJneSAtPSAxO1xuICAgIHRoaXMuZ3JpZC5zZXQodmVjdG9yLCBudWxsKTtcbiAgICB0aGlzLmdyaWQuc2V0KGRlc3QsIGNyaXR0ZXIpO1xuICAgIHJldHVybiB0cnVlO1xufTtcbmFjdGlvblR5cGVzLmVhdCA9IGZ1bmN0aW9uIChjcml0dGVyLCB2ZWN0b3IsIGFjdGlvbikge1xuICAgIHZhciBkZXN0ID0gdGhpcy5jaGVja0Rlc3RpbmF0aW9uKGFjdGlvbiwgdmVjdG9yKTtcbiAgICB2YXIgYXREZXN0ID0gZGVzdCAhPSBudWxsICYmIHRoaXMuZ3JpZC5nZXQoZGVzdCk7XG4gICAgaWYgKCFhdERlc3QgfHwgYXREZXN0LmVuZXJneSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY3JpdHRlci5lbmVyZ3kgKz0gYXREZXN0LmVuZXJneTtcbiAgICB0aGlzLmdyaWQuc2V0KGRlc3QsIG51bGwpO1xuICAgIHJldHVybiB0cnVlO1xufTtcbmFjdGlvblR5cGVzLnJlcHJvZHVjZSA9IGZ1bmN0aW9uIChjcml0dGVyLCB2ZWN0b3IsIGFjdGlvbikge1xuICAgIHZhciBiYWJ5ID0gZWxlbWVudEZyb21DaGFyKHRoaXMubGVnZW5kLCBjcml0dGVyLm9yaWdpbkNoYXIpO1xuICAgIHZhciBkZXN0ID0gdGhpcy5jaGVja0Rlc3RpbmF0aW9uKGFjdGlvbiwgdmVjdG9yKTtcbiAgICBpZiAoZGVzdCA9PSBudWxsIHx8IGNyaXR0ZXIuZW5lcmd5IDw9IDIgKiBiYWJ5LmVuZXJneSB8fCB0aGlzLmdyaWQuZ2V0KGRlc3QpICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjcml0dGVyLmVuZXJneSAtPSAyICogYmFieS5lbmVyZ3k7XG4gICAgdGhpcy5ncmlkLnNldChkZXN0LCBiYWJ5KTtcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG52YXIgUGxhbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBsYW50KGVuZXJneSkge1xuICAgICAgICB0aGlzLmVuZXJneSA9IDMgKyBNYXRoLnJhbmRvbSgpICogNDtcbiAgICB9XG4gICAgUGxhbnQucHJvdG90eXBlLmFjdCA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmICh0aGlzLmVuZXJneSA+IDE1KSB7XG4gICAgICAgICAgICB2YXIgc3BhY2UgPSB2aWV3LmZpbmQoXCIgXCIpO1xuICAgICAgICAgICAgaWYgKHNwYWNlKVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwicmVwcm9kdWNlXCIsXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogc3BhY2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmVuZXJneSA8IDIwKVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcImdyb3dcIixcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IHVuZGVmaW5lZFxuICAgICAgICAgICAgfTtcbiAgICB9O1xuICAgIHJldHVybiBQbGFudDtcbn0oKSk7XG52YXIgUGxhbnRFYXRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGxhbnRFYXRlcihlbmVyZ3kpIHtcbiAgICAgICAgdGhpcy5lbmVyZ3kgPSAyMDtcbiAgICB9XG4gICAgUGxhbnRFYXRlci5wcm90b3R5cGUuYWN0ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIHNwYWNlID0gdmlldy5maW5kKCcgJyk7XG4gICAgICAgIGlmICh0aGlzLmVuZXJneSA+IDYwICYmIHNwYWNlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdyZXByb2R1Y2UnLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogc3BhY2VcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBsYW50ID0gdmlldy5maW5kKCcqJyk7XG4gICAgICAgIGlmIChwbGFudCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZWF0JyxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IHBsYW50XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzcGFjZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnbW92ZScsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBzcGFjZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFBsYW50RWF0ZXI7XG59KCkpO1xudmFyIHZhbGxleSA9IG5ldyBMaWZlbGlrZVdvcmxkKFtcIiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIjIyMjIyAgICAgICAgICAgICAgICAgIyMjIyMjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIyMgICAqKiogICAgICAgICAgICAgICAgKiojI1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiMgICAqIyMqKiAgICAgICAgICoqICBPICAqIyNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIjICAgICoqKiAgICAgTyAgICAjIyoqICAgICojXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIyAgICAgICBPICAgICAgICAgIyMqKiogICAgI1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiMgICAgICAgICAgICAgICAgICMjKiogICAgICNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIjICAgTyAgICAgICAjKiAgICAgICAgICAgICAjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIyogICAgICAgICAgIyoqICAgICAgIE8gICAgI1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIiMqKiogICAgICAgICMjKiogICAgTyAgICAqKiNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIjIyoqKiogICAgICMjIyoqKiAgICAgICAqIyMjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1wiXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgXCIjXCI6IFdhbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiT1wiOiAgIFBsYW50RWF0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiKlwiOiAgIFBsYW50IH0pO1xuLy9wcmludCAxMCB0dXJucyBvZiBsaWZlLlxuZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgdmFsbGV5LnR1cm4oKTtcbiAgICBjb25zb2xlLmxvZyh2YWxsZXkudG9TdHJpbmcoKSk7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9jaDcvY2g3LXByb2ouanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xufTtcbi8vUFJPQkxFTSAxIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG52YXIgVmVjdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBWZWN0b3IoeCwgeSkge1xuICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICB0aGlzLnkgPSB5O1xuICAgIH1cbiAgICBWZWN0b3IucHJvdG90eXBlLnBsdXMgPSBmdW5jdGlvbiAoYWx0KSB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yKHRoaXMueCArIGFsdC54LCB0aGlzLnkgKyBhbHQueSk7XG4gICAgfTtcbiAgICBWZWN0b3IucHJvdG90eXBlLm1pbnVzID0gZnVuY3Rpb24gKGFsdCkge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3Rvcih0aGlzLnggLSBhbHQueCwgdGhpcy55IC0gYWx0LnkpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlY3Rvci5wcm90b3R5cGUsIFwibGVuZ3RoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KCh0aGlzLnggKiB0aGlzLngpICsgKHRoaXMueSAqIHRoaXMueSkpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gVmVjdG9yO1xufSgpKTtcbmV4cG9ydHMuVmVjdG9yID0gVmVjdG9yO1xuLy9jb25zb2xlLmxvZyhuZXcgVmVjdG9yKDEsIDIpLnBsdXMobmV3IFZlY3RvcigyLCAzKSkpO1xuLy8g4oaSIFZlY3Rvcnt4OiAzLCB5OiA1fVxuLy9jb25zb2xlLmxvZyhuZXcgVmVjdG9yKDEsIDIpLm1pbnVzKG5ldyBWZWN0b3IoMiwgMykpKTtcbi8vIOKGkiBWZWN0b3J7eDogLTEsIHk6IC0xfVxuLy9jb25zb2xlLmxvZyhuZXcgVmVjdG9yKDMsIDQpLmxlbmd0aCk7XG4vLyDihpIgNVxuLy9QUk9CTEVNIDIgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vZnJvbSB0ZXh0Ym9vay5cbmZ1bmN0aW9uIHJlcGVhdChzdHJpbmcsIHRpbWVzKSB7XG4gICAgdmFyIHJlc3VsdCA9ICcnO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGltZXM7IGkrKylcbiAgICAgICAgcmVzdWx0ICs9IHN0cmluZztcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuLy9pbmZlcnJlZCBmcm9tIHRleHRib29rLlxuLy9taW5XaWR0aCBhbmQgbWluSGVpZ2h0IG1ldGhvZHMgaGF2ZSBiZWVuIGFsdGVyZWQgZnJvbSBvcmlnaW5hbCBjb2RlLlxudmFyIFRleHRDZWxsID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUZXh0Q2VsbCh0ZXh0KSB7XG4gICAgICAgIHRoaXMudGV4dCA9IHRleHQuc3BsaXQoJycpO1xuICAgIH1cbiAgICBUZXh0Q2VsbC5wcm90b3R5cGUubWluV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHQubGVuZ3RoO1xuICAgIH07XG4gICAgVGV4dENlbGwucHJvdG90eXBlLm1pbkhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfTtcbiAgICBUZXh0Q2VsbC5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIGxpbmUgPSB0aGlzLnRleHRbaV0gfHwgJyc7XG4gICAgICAgICAgICByZXN1bHQucHVzaChsaW5lICsgcmVwZWF0KCcgJywgd2lkdGggLSBsaW5lLmxlbmd0aCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICByZXR1cm4gVGV4dENlbGw7XG59KCkpO1xudmFyIFN0cmV0Y2hDZWxsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3RyZXRjaENlbGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3RyZXRjaENlbGwodGV4dCwgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCB0ZXh0KTtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICB9XG4gICAgU3RyZXRjaENlbGwucHJvdG90eXBlLm1pbldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy53aWR0aCwgX3N1cGVyLnByb3RvdHlwZS5taW5XaWR0aC5jYWxsKHRoaXMpKTtcbiAgICB9O1xuICAgIFN0cmV0Y2hDZWxsLnByb3RvdHlwZS5taW5IZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBNYXRoLm1heCh0aGlzLmhlaWdodCwgX3N1cGVyLnByb3RvdHlwZS5taW5IZWlnaHQuY2FsbCh0aGlzKSk7XG4gICAgfTtcbiAgICBTdHJldGNoQ2VsbC5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLmRyYXcuY2FsbCh0aGlzLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gICAgfTtcbiAgICByZXR1cm4gU3RyZXRjaENlbGw7XG59KFRleHRDZWxsKSk7XG52YXIgc2MgPSBuZXcgU3RyZXRjaENlbGwoJ2FiYycsIDEsIDIpO1xuLy9jb25zb2xlLmxvZyhzYy5taW5XaWR0aCgpKTtcbi8vIOKGkiAzXG4vL2NvbnNvbGUubG9nKHNjLm1pbkhlaWdodCgpKTtcbi8vIOKGkiAyXG4vL2NvbnNvbGUubG9nKHNjLmRyYXcoMywgMikpO1xuLy8gZHJhdyBtZXRob2QgaW5oZXJpdGVkIGZyb20gdGV4dC4gT3V0cHV0IGRvZXNuJ3QgcGFzcyB0ZXN0LiDCr1xcXyjjg4QpXy/CryBcbi8vIOKGkiBbJ2FiYycsICcgICAnXVxuLy9QUk9CTEVNIDMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmZ1bmN0aW9uIGxvZ0ZpdmUoc2VxKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgICAgaWYgKCFzZXEubmV4dCgpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhzZXEuY3VycmVudCgpKTtcbiAgICB9XG59XG52YXIgQXJyYXlTZXEgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFycmF5U2VxKGFycmF5KSB7XG4gICAgICAgIHRoaXMucG9zID0gLTE7XG4gICAgICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbiAgICB9XG4gICAgQXJyYXlTZXEucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvcyA+PSB0aGlzLmFycmF5Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBvcysrO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIEFycmF5U2VxLnByb3RvdHlwZS5jdXJyZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcnJheVt0aGlzLnBvc107XG4gICAgfTtcbiAgICByZXR1cm4gQXJyYXlTZXE7XG59KCkpO1xuLy91c2luZyBzdGFydCBhbmQgZW5kIGluc3RlYWQgb2YgZnJvbSBhbmQgdG8gYXJndW1lbnRzLlxudmFyIFJhbmdlU2VxID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSYW5nZVNlcShzdGFydCwgZW5kKSB7XG4gICAgICAgIHRoaXMucG9zID0gc3RhcnQgLSAxO1xuICAgICAgICB0aGlzLmVuZCA9IGVuZDtcbiAgICB9XG4gICAgUmFuZ2VTZXEucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnBvcyA+PSB0aGlzLmVuZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9zKys7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgUmFuZ2VTZXEucHJvdG90eXBlLmN1cnJlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBvcztcbiAgICB9O1xuICAgIHJldHVybiBSYW5nZVNlcTtcbn0oKSk7XG4vL2xvZ0ZpdmUobmV3IEFycmF5U2VxKFsxLCAyXSkpO1xuLy8g4oaSIDFcbi8vIOKGkiAyXG4vL2xvZ0ZpdmUobmV3IFJhbmdlU2VxKDEwMCwgMTAwMCkpO1xuLy8g4oaSIDEwMFxuLy8g4oaSIDEwMVxuLy8g4oaSIDEwMlxuLy8g4oaSIDEwM1xuLy8g4oaSIDEwNFxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY2g2L2NoNi1leC5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9