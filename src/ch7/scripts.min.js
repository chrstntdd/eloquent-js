/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(1);
	__webpack_require__(2);

/***/ },
/* 1 */
/***/ function(module, exports) {

	// test: no
	
	(function() {
	  "use strict";
	
	  var active = null;
	
	  function Animated(world) {
	    this.world = world;
	    var outer = (window.__sandbox ? window.__sandbox.output.div : document.body), doc = outer.ownerDocument;
	    var node = outer.appendChild(doc.createElement("div"));
	    node.style.cssText = "position: relative; width: intrinsic; width: fit-content;";
	    this.pre = node.appendChild(doc.createElement("pre"));
	    this.pre.appendChild(doc.createTextNode(world.toString()));
	    this.button = node.appendChild(doc.createElement("div"));
	    this.button.style.cssText = "position: absolute; bottom: 8px; right: -4.5em; color: white; font-family: tahoma, arial; " +
	      "background: #4ab; cursor: pointer; border-radius: 18px; font-size: 70%; width: 3.5em; text-align: center;";
	    this.button.innerHTML = "stop";
	    var self = this;
	    this.button.addEventListener("click", function() { self.clicked(); });
	    this.disabled = false;
	    if (active) active.disable();
	    active = this;
	    this.interval = setInterval(function() { self.tick(); }, 333);
	  }
	
	  Animated.prototype.clicked = function() {
	    if (this.disabled) return;
	    if (this.interval) {
	      clearInterval(this.interval);
	      this.interval = null;
	      this.button.innerHTML = "start";
	    } else {
	      var self = this;
	      this.interval = setInterval(function() { self.tick(); }, 333);
	      this.button.innerHTML = "stop";
	    }
	  };
	
	  Animated.prototype.tick = function() {
	    this.world.turn();
	    this.pre.removeChild(this.pre.firstChild);
	    this.pre.appendChild(this.pre.ownerDocument.createTextNode(this.world.toString()));
	  };
	
	  Animated.prototype.disable = function() {
	    this.disabled = true;
	    clearInterval(this.interval);
	    this.button.innerHTML = "Disabled";
	    this.button.style.color = "red";
	  };
	
	  window.animateWorld = function(world) { new Animated(world); };
	})();

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	var __extends = (this && this.__extends) || function (d, b) {
	    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
	    function __() { this.constructor = d; }
	    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
	};
	var ch6_ex_1 = __webpack_require__(3);
	var directions = {
	    'n': new ch6_ex_1.Vector(0, 1),
	    'ne': new ch6_ex_1.Vector(1, -1),
	    'e': new ch6_ex_1.Vector(1, 0),
	    'se': new ch6_ex_1.Vector(0, -1),
	    's': new ch6_ex_1.Vector(0, 1),
	    'sw': new ch6_ex_1.Vector(-1, 1),
	    'w': new ch6_ex_1.Vector(-1, 0),
	    'nw': new ch6_ex_1.Vector(-1, -1)
	};
	var plan = ['############################',
	    '#      #    #      o      ##',
	    '#                          #',
	    '#          #####           #',
	    '##         #   #    ##     #',
	    '###           ##     #     #',
	    '#           ###      #     #',
	    '#   ####                   #',
	    '#   ##       o             #',
	    '# o  #         o       ### #',
	    '#    #                     #',
	    '############################'];
	var directionNames = 'n ne e se s sw w nw'.split(' ');
	function randomElement(array) {
	    return array[Math.floor(Math.random() * array.length)];
	}
	var Grid = (function () {
	    function Grid(width, height) {
	        this.space = new Array(width * height);
	        this.width = width;
	        this.height = height;
	    }
	    Grid.prototype.isInside = function (vector) {
	        return vector.x >= 0 && vector.x < this.width &&
	            vector.y >= 0 && vector.y < this.height;
	    };
	    ;
	    Grid.prototype.get = function (vector) {
	        return this.space[vector.x + this.width * vector.y];
	    };
	    ;
	    Grid.prototype.set = function (vector, value) {
	        this.space[vector.x + this.width * vector.y] = value;
	    };
	    ;
	    Grid.prototype.forEach = function (f, context) {
	        for (var y = 0; y < this.height; y++) {
	            for (var x = 0; x < this.width; x++) {
	                var value = this.space[x + y * this.width];
	                if (value != null)
	                    f.call(context, value, new ch6_ex_1.Vector(x, y));
	            }
	        }
	    };
	    ;
	    return Grid;
	}());
	function elementFromChar(legend, ch) {
	    if (ch == ' ')
	        return null;
	    var element = new legend[ch]();
	    element.originChar = ch;
	    return element;
	}
	function charFromElement(element) {
	    if (element == null)
	        return ' ';
	    else
	        return element.originChar;
	}
	function Wall() { }
	;
	var BouncingCritter = (function () {
	    function BouncingCritter(direction) {
	        this.direction = randomElement(directionNames);
	    }
	    BouncingCritter.prototype.act = function (view) {
	        if (view.look(this.direction) != ' ') {
	            this.direction = view.find(' ') || 's';
	        }
	        return { type: 'move', direction: this.direction };
	    };
	    return BouncingCritter;
	}());
	var World = (function () {
	    function World(map, legend) {
	        var grid = new Grid(map[0].length, map.length);
	        this.grid = grid;
	        this.legend = legend;
	        this.map = map.forEach(function (line, y) {
	            for (var x = 0; x < line.length; x++)
	                grid.set(new ch6_ex_1.Vector(x, y), elementFromChar(legend, line[x]));
	        });
	    }
	    ;
	    World.prototype.toString = function () {
	        var output = '';
	        for (var y = 0; y < this.grid.height; y++) {
	            for (var x = 0; x < this.grid.width; x++) {
	                var element = this.grid.get(new ch6_ex_1.Vector(x, y));
	                output += charFromElement(element);
	            }
	            output += '\n';
	        }
	        return output;
	    };
	    ;
	    World.prototype.turn = function () {
	        var acted = [];
	        this.grid.forEach(function (critter, vector) {
	            if (critter.act && acted.indexOf(critter) == -1) {
	                acted.push(critter);
	                this.letAct(critter, vector);
	            }
	        }, this);
	    };
	    ;
	    World.prototype.letAct = function (critter, vector) {
	        var action = critter.act(new View(this, vector));
	        if (action && action.type == 'move') {
	            var dest = this.checkDestination(action, vector);
	            if (dest && this.grid.get(dest) == null) {
	                this.grid.set(vector, null);
	                this.grid.set(dest, critter);
	            }
	        }
	    };
	    ;
	    World.prototype.checkDestination = function (action, vector) {
	        if (directions.hasOwnProperty(action.direction)) {
	            var dest = vector.plus(directions[action.direction]);
	            if (this.grid.isInside(dest))
	                return dest;
	        }
	    };
	    ;
	    return World;
	}());
	var View = (function () {
	    function View(world, vector) {
	        this.world = world;
	        this.vector = vector;
	    }
	    View.prototype.look = function (dir) {
	        var target = this.vector.plus(directions[dir]);
	        if (this.world.grid.isInside(target))
	            return charFromElement(this.world.grid.get(target));
	        else
	            return '#';
	    };
	    ;
	    View.prototype.findAll = function (ch) {
	        var found = [];
	        for (var dir in directions)
	            if (this.look(dir) == ch)
	                found.push(dir);
	        return found;
	    };
	    ;
	    View.prototype.find = function (ch) {
	        var found = this.findAll(ch);
	        if (found.length == 0)
	            return null;
	        return randomElement(found);
	    };
	    ;
	    return View;
	}());
	function dirPlus(dir, n) {
	    var index = directionNames.indexOf(dir);
	    return directionNames[(index + n + 8) % 8];
	}
	var WallFlower = (function () {
	    function WallFlower(dir) {
	        this.dir = 's';
	    }
	    ;
	    WallFlower.prototype.act = function (view) {
	        var start = this.dir;
	        if (view.look(dirPlus(this.dir, -3)) != ' ')
	            start = this.dir = dirPlus(this.dir, -2);
	        while (view.look(this.dir) != ' ') {
	            this.dir = dirPlus(this.dir, 1);
	            if (this.dir == start)
	                break;
	        }
	        return { type: 'move', direction: this.dir };
	    };
	    ;
	    return WallFlower;
	}());
	var LifelikeWorld = (function (_super) {
	    __extends(LifelikeWorld, _super);
	    function LifelikeWorld(map, legend) {
	        _super.call(this, map, legend);
	        World.call(this, map, legend);
	        Object.create(World);
	    }
	    LifelikeWorld.prototype.letAct = function (critter, vector) {
	        var action = critter.act(new View(this, vector));
	        var handled = action &&
	            action.type in actionTypes &&
	            actionTypes[action.type].call(this, critter, vector, action);
	        if (!handled) {
	            critter.energy -= 0.2;
	            if (critter.energy <= 0)
	                this.grid.set(vector, null);
	        }
	    };
	    ;
	    return LifelikeWorld;
	}(World));
	var actionTypes = Object.create(null);
	actionTypes.grow = function (critter) {
	    critter.energy += 0.5;
	    return true;
	};
	actionTypes.move = function (critter, vector, action) {
	    var dest = this.checkDestination(action, vector);
	    if (dest == null || critter.energy <= 1 || this.grid.get(dest) != null)
	        return false;
	    critter.energy -= 1;
	    this.grid.set(vector, null);
	    this.grid.set(dest, critter);
	    return true;
	};
	actionTypes.eat = function (critter, vector, action) {
	    var dest = this.checkDestination(action, vector);
	    var atDest = dest != null && this.grid.get(dest);
	    if (!atDest || atDest.energy == null)
	        return false;
	    critter.energy += atDest.energy;
	    this.grid.set(dest, null);
	    return true;
	};
	actionTypes.reproduce = function (critter, vector, action) {
	    var baby = elementFromChar(this.legend, critter.originChar);
	    var dest = this.checkDestination(action, vector);
	    if (dest == null || critter.energy <= 2 * baby.energy || this.grid.get(dest) != null)
	        return false;
	    critter.energy -= 2 * baby.energy;
	    this.grid.set(dest, baby);
	    return true;
	};
	var Plant = (function () {
	    function Plant(energy) {
	        this.energy = 3 + Math.random() * 4;
	    }
	    Plant.prototype.act = function (view) {
	        if (this.energy > 15) {
	            var space = view.find(' ');
	            if (space)
	                return { type: 'reproduce', direction: space };
	        }
	        if (this.energy < 20)
	            return { type: 'grow', direction: undefined };
	    };
	    ;
	    return Plant;
	}());
	var PlantEater = (function () {
	    function PlantEater(energy) {
	        this.energy = 20;
	    }
	    PlantEater.prototype.act = function (view) {
	        var space = view.find(' ');
	        if (this.energy > 60 && space) {
	            return { type: 'reproduce', direction: space };
	        }
	        var plant = view.find('*');
	        if (plant) {
	            return { type: 'eat', direction: plant };
	        }
	        if (space) {
	            return { type: 'move', direction: space };
	        }
	    };
	    ;
	    return PlantEater;
	}());
	// var valley = new LifelikeWorld(
	//   ['############################',
	//    '#####                 ######',
	//    '##   ***                **##',
	//    '#   *##**         **  O  *##',
	//    '#    ***     O    ##**    *#',
	//    '#       O         ##***    #',
	//    '#                 ##**     #',
	//    '#   O       #*             #',
	//    '#*          #**       O    #',
	//    '#***        ##**    O    **#',
	//    '##****     ###***       *###',
	//    '############################'],
	//   {'#': Wall,
	//    'O': PlantEater,
	//    '*': Plant}
	// );
	// animateWorld(valley);
	///////////////////////////////////////////////////////////////////////
	//Problem 1
	var SmartPlantEater = (function () {
	    function SmartPlantEater(energy, dir) {
	        this.energy = 20;
	        this.dir = randomElement(directionNames);
	    }
	    SmartPlantEater.prototype.act = function (view) {
	        var space = view.find(' ');
	        var plants = view.findAll('*');
	        if (this.energy > 95 && space)
	            return { type: 'reproduce', direction: space };
	        if (plants.length > 1)
	            return { type: 'eat', direction: randomElement(plants) };
	        if (view.look(this.dir) != ' ' && space)
	            this.dir = space;
	        return { type: 'move', direction: this.dir };
	    };
	    ;
	    return SmartPlantEater;
	}());
	// animateWorld(new LifelikeWorld(
	//   ['############################',
	//    '#####                 ######',
	//    '##   ***                **##',
	//    '#   *##**         **  O  *##',
	//    '#    ***     O    ##**    *#',
	//    '#       O         ##***    #',
	//    '#                 ##**     #',
	//    '#   O       #*             #',
	//    '#*          #**       O    #',
	//    '#***        ##**    O    **#',
	//    '##****     ###***       *###',
	//    '############################'],
	//   {'#': Wall,
	//    'O': SmartPlantEater,
	//    '*': Plant}
	// ));
	//PROBLEM 2
	actionTypes.stay = function (critter, vector, action) {
	    return false;
	};
	var Tiger = (function () {
	    function Tiger(energy, dir, memory) {
	        this.energy = 90;
	        this.dir = randomElement(directionNames);
	        this.memory = []; //holds count of number of prey around predator each turn.
	    }
	    Tiger.prototype.act = function (view) {
	        var seenEachTurn = this.memory.reduce(function (a, b) { return a + b; }, 0) / this.memory.length;
	        var prey = view.findAll('O');
	        var space = view.find(' ');
	        this.memory.push(prey.length);
	        if (this.memory.length > 5)
	            this.memory.shift();
	        if (prey.length && seenEachTurn > 0.33)
	            return { type: 'eat', direction: randomElement(prey) };
	        if (seenEachTurn < 0.10)
	            return { type: 'stay', direction: undefined };
	        if (this.energy > 300 && space)
	            return { type: 'reproduce', direction: space };
	        if (view.look(this.dir) != ' ' && space)
	            this.dir = space;
	        return { type: 'move', direction: this.dir };
	    };
	    ;
	    return Tiger;
	}());
	animateWorld(new LifelikeWorld(['####################################################',
	    '#                 ####         ****              ###',
	    '#   *  @  ##                 ########       OO    ##',
	    '#   *    ##        O O                 ****       *#',
	    '#       ##*                        ##########     *#',
	    '#      ##***  *         ****                     **#',
	    '#* **  #  *  ***      #########                  **#',
	    '#* **  #      *               #   *              **#',
	    '#     ##              #   O   #  ***          ######',
	    '#*            @       #       #   *        O  #    #',
	    '#*                    #  ######                 ** #',
	    '###          ****          ***                  ** #',
	    '#       O                        @         O       #',
	    '#   *     ##  ##  ##  ##               ###      *  #',
	    '#   **         #              *       #####  O     #',
	    '##  **  O   O  #  #    ***  ***        ###      ** #',
	    '###               #   *****                    ****#',
	    '####################################################'], { '#': Wall,
	    '@': Tiger,
	    'O': SmartPlantEater,
	    '*': Plant }));


/***/ },
/* 3 */
/***/ function(module, exports) {

	"use strict";
	var __extends = (this && this.__extends) || function (d, b) {
	    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
	    function __() { this.constructor = d; }
	    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
	};
	//PROBLEM 1 /////////////////////////////////////////////////////////////////////////////
	var Vector = (function () {
	    function Vector(x, y) {
	        this.x = x;
	        this.y = y;
	    }
	    Vector.prototype.plus = function (alt) {
	        return new Vector(this.x + alt.x, this.y + alt.y);
	    };
	    Vector.prototype.minus = function (alt) {
	        return new Vector(this.x - alt.x, this.y - alt.y);
	    };
	    Object.defineProperty(Vector.prototype, "length", {
	        get: function () {
	            return Math.sqrt((this.x * this.x) + (this.y * this.y));
	        },
	        enumerable: true,
	        configurable: true
	    });
	    return Vector;
	}());
	exports.Vector = Vector;
	//console.log(new Vector(1, 2).plus(new Vector(2, 3)));
	// → Vector{x: 3, y: 5}
	//console.log(new Vector(1, 2).minus(new Vector(2, 3)));
	// → Vector{x: -1, y: -1}
	//console.log(new Vector(3, 4).length);
	// → 5
	//PROBLEM 2 /////////////////////////////////////////////////////////////////////////////
	//from textbook.
	function repeat(string, times) {
	    var result = '';
	    for (var i = 0; i < times; i++)
	        result += string;
	    return result;
	}
	//inferred from textbook.
	//minWidth and minHeight methods have been altered from original code.
	var TextCell = (function () {
	    function TextCell(text) {
	        this.text = text.split('');
	    }
	    TextCell.prototype.minWidth = function () {
	        return this.text.length;
	    };
	    TextCell.prototype.minHeight = function () {
	        return 1;
	    };
	    TextCell.prototype.draw = function (width, height) {
	        var result = [];
	        for (var i = 0; i < height; i++) {
	            var line = this.text[i] || '';
	            result.push(line + repeat(' ', width - line.length));
	        }
	        return result;
	    };
	    return TextCell;
	}());
	var StretchCell = (function (_super) {
	    __extends(StretchCell, _super);
	    function StretchCell(text, width, height) {
	        _super.call(this, text);
	        this.width = width;
	        this.height = height;
	    }
	    StretchCell.prototype.minWidth = function () {
	        return Math.max(this.width, _super.prototype.minWidth.call(this));
	    };
	    StretchCell.prototype.minHeight = function () {
	        return Math.max(this.height, _super.prototype.minHeight.call(this));
	    };
	    StretchCell.prototype.draw = function (width, height) {
	        return _super.prototype.draw.call(this, this.width, this.height);
	    };
	    return StretchCell;
	}(TextCell));
	var sc = new StretchCell('abc', 1, 2);
	//console.log(sc.minWidth());
	// → 3
	//console.log(sc.minHeight());
	// → 2
	//console.log(sc.draw(3, 2));
	// draw method inherited from text. Output doesn't pass test. ¯\_(ツ)_/¯ 
	// → ['abc', '   ']
	//PROBLEM 3 /////////////////////////////////////////////////////////////////////////////
	function logFive(seq) {
	    for (var i = 0; i < 5; i++) {
	        if (!seq.next()) {
	            break;
	        }
	        console.log(seq.current());
	    }
	}
	var ArraySeq = (function () {
	    function ArraySeq(array) {
	        this.pos = -1;
	        this.array = array;
	    }
	    ArraySeq.prototype.next = function () {
	        if (this.pos >= this.array.length - 1) {
	            return false;
	        }
	        this.pos++;
	        return true;
	    };
	    ArraySeq.prototype.current = function () {
	        return this.array[this.pos];
	    };
	    return ArraySeq;
	}());
	//using start and end instead of from and to arguments.
	var RangeSeq = (function () {
	    function RangeSeq(start, end) {
	        this.pos = start - 1;
	        this.end = end;
	    }
	    RangeSeq.prototype.next = function () {
	        if (this.pos >= this.end) {
	            return false;
	        }
	        this.pos++;
	        return true;
	    };
	    RangeSeq.prototype.current = function () {
	        return this.pos;
	    };
	    return RangeSeq;
	}());
	//logFive(new ArraySeq([1, 2]));
	// → 1
	// → 2
	//logFive(new RangeSeq(100, 1000));
	// → 100
	// → 101
	// → 102
	// → 103
	// → 104


/***/ }
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgYjNjYzIzMTU1NzEwZjQ5NDUyMGYiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NoNy9zY3JpcHRzLmpzIiwid2VicGFjazovLy8uL3NyYy9jaDcvYW5pbWF0ZXdvcmxkLmpzIiwid2VicGFjazovLy8uL3NyYy9jaDcvY2g3LXByb2ouanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NoNi9jaDYtZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7QUN0Q0E7QUFDQSx3Qjs7Ozs7O0FDREE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxrQkFBa0Isb0JBQW9CO0FBQ25GO0FBQ0E7QUFDQTtBQUNBLHFEQUFvRCxhQUFhLGVBQWUsY0FBYyw0QkFBNEI7QUFDMUgseUJBQXdCLGlCQUFpQixxQkFBcUIsZ0JBQWdCLGNBQWMsb0JBQW9CO0FBQ2hIO0FBQ0E7QUFDQSx1REFBc0QsZ0JBQWdCLEVBQUU7QUFDeEU7QUFDQTtBQUNBO0FBQ0EsNkNBQTRDLGFBQWEsRUFBRTtBQUMzRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSwrQ0FBOEMsYUFBYSxFQUFFO0FBQzdEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwwQ0FBeUMscUJBQXFCO0FBQzlELEVBQUMsSTs7Ozs7O0FDckREO0FBQ0E7QUFDQTtBQUNBLG9CQUFtQixzQkFBc0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBdUIsaUJBQWlCO0FBQ3hDLDRCQUEyQixnQkFBZ0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBZ0I7QUFDaEI7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBMkIsaUJBQWlCO0FBQzVDO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXVCLHNCQUFzQjtBQUM3Qyw0QkFBMkIscUJBQXFCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF3QjtBQUN4QjtBQUNBO0FBQ0EscUJBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxxQkFBb0I7QUFDcEI7QUFDQTtBQUNBLHFCQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBb0I7QUFDcEI7QUFDQSxxQkFBb0I7QUFDcEI7QUFDQTtBQUNBLGlCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUF5QjtBQUN6QjtBQUNBO0FBQ0EsZ0VBQStELGNBQWMsRUFBRTtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBb0I7QUFDcEI7QUFDQSxxQkFBb0I7QUFDcEI7QUFDQSxxQkFBb0I7QUFDcEI7QUFDQTtBQUNBLGlCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUE4RDtBQUM5RDtBQUNBO0FBQ0EsaUJBQWdCOzs7Ozs7O0FDelloQjtBQUNBO0FBQ0E7QUFDQSxvQkFBbUIsc0JBQXNCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFTO0FBQ1Q7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0EsYUFBWTtBQUNaO0FBQ0EsYUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFtQixXQUFXO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBdUIsWUFBWTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InNjcmlwdHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgYjNjYzIzMTU1NzEwZjQ5NDUyMGYiLCJyZXF1aXJlKCcuL2FuaW1hdGV3b3JsZC5qcycpO1xucmVxdWlyZSgnLi9jaDctcHJvai5qcycpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2NoNy9zY3JpcHRzLmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vIHRlc3Q6IG5vXG5cbihmdW5jdGlvbigpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGFjdGl2ZSA9IG51bGw7XG5cbiAgZnVuY3Rpb24gQW5pbWF0ZWQod29ybGQpIHtcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgdmFyIG91dGVyID0gKHdpbmRvdy5fX3NhbmRib3ggPyB3aW5kb3cuX19zYW5kYm94Lm91dHB1dC5kaXYgOiBkb2N1bWVudC5ib2R5KSwgZG9jID0gb3V0ZXIub3duZXJEb2N1bWVudDtcbiAgICB2YXIgbm9kZSA9IG91dGVyLmFwcGVuZENoaWxkKGRvYy5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtcbiAgICBub2RlLnN0eWxlLmNzc1RleHQgPSBcInBvc2l0aW9uOiByZWxhdGl2ZTsgd2lkdGg6IGludHJpbnNpYzsgd2lkdGg6IGZpdC1jb250ZW50O1wiO1xuICAgIHRoaXMucHJlID0gbm9kZS5hcHBlbmRDaGlsZChkb2MuY3JlYXRlRWxlbWVudChcInByZVwiKSk7XG4gICAgdGhpcy5wcmUuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZVRleHROb2RlKHdvcmxkLnRvU3RyaW5nKCkpKTtcbiAgICB0aGlzLmJ1dHRvbiA9IG5vZGUuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO1xuICAgIHRoaXMuYnV0dG9uLnN0eWxlLmNzc1RleHQgPSBcInBvc2l0aW9uOiBhYnNvbHV0ZTsgYm90dG9tOiA4cHg7IHJpZ2h0OiAtNC41ZW07IGNvbG9yOiB3aGl0ZTsgZm9udC1mYW1pbHk6IHRhaG9tYSwgYXJpYWw7IFwiICtcbiAgICAgIFwiYmFja2dyb3VuZDogIzRhYjsgY3Vyc29yOiBwb2ludGVyOyBib3JkZXItcmFkaXVzOiAxOHB4OyBmb250LXNpemU6IDcwJTsgd2lkdGg6IDMuNWVtOyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI7XG4gICAgdGhpcy5idXR0b24uaW5uZXJIVE1MID0gXCJzdG9wXCI7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHsgc2VsZi5jbGlja2VkKCk7IH0pO1xuICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBpZiAoYWN0aXZlKSBhY3RpdmUuZGlzYWJsZSgpO1xuICAgIGFjdGl2ZSA9IHRoaXM7XG4gICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgeyBzZWxmLnRpY2soKTsgfSwgMzMzKTtcbiAgfVxuXG4gIEFuaW1hdGVkLnByb3RvdHlwZS5jbGlja2VkID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHJldHVybjtcbiAgICBpZiAodGhpcy5pbnRlcnZhbCkge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcbiAgICAgIHRoaXMuaW50ZXJ2YWwgPSBudWxsO1xuICAgICAgdGhpcy5idXR0b24uaW5uZXJIVE1MID0gXCJzdGFydFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7IHNlbGYudGljaygpOyB9LCAzMzMpO1xuICAgICAgdGhpcy5idXR0b24uaW5uZXJIVE1MID0gXCJzdG9wXCI7XG4gICAgfVxuICB9O1xuXG4gIEFuaW1hdGVkLnByb3RvdHlwZS50aWNrID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy53b3JsZC50dXJuKCk7XG4gICAgdGhpcy5wcmUucmVtb3ZlQ2hpbGQodGhpcy5wcmUuZmlyc3RDaGlsZCk7XG4gICAgdGhpcy5wcmUuYXBwZW5kQ2hpbGQodGhpcy5wcmUub3duZXJEb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLndvcmxkLnRvU3RyaW5nKCkpKTtcbiAgfTtcblxuICBBbmltYXRlZC5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlO1xuICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XG4gICAgdGhpcy5idXR0b24uaW5uZXJIVE1MID0gXCJEaXNhYmxlZFwiO1xuICAgIHRoaXMuYnV0dG9uLnN0eWxlLmNvbG9yID0gXCJyZWRcIjtcbiAgfTtcblxuICB3aW5kb3cuYW5pbWF0ZVdvcmxkID0gZnVuY3Rpb24od29ybGQpIHsgbmV3IEFuaW1hdGVkKHdvcmxkKTsgfTtcbn0pKCk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY2g3L2FuaW1hdGV3b3JsZC5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59O1xudmFyIGNoNl9leF8xID0gcmVxdWlyZSgnLi4vY2g2L2NoNi1leCcpO1xudmFyIGRpcmVjdGlvbnMgPSB7XG4gICAgJ24nOiBuZXcgY2g2X2V4XzEuVmVjdG9yKDAsIDEpLFxuICAgICduZSc6IG5ldyBjaDZfZXhfMS5WZWN0b3IoMSwgLTEpLFxuICAgICdlJzogbmV3IGNoNl9leF8xLlZlY3RvcigxLCAwKSxcbiAgICAnc2UnOiBuZXcgY2g2X2V4XzEuVmVjdG9yKDAsIC0xKSxcbiAgICAncyc6IG5ldyBjaDZfZXhfMS5WZWN0b3IoMCwgMSksXG4gICAgJ3N3JzogbmV3IGNoNl9leF8xLlZlY3RvcigtMSwgMSksXG4gICAgJ3cnOiBuZXcgY2g2X2V4XzEuVmVjdG9yKC0xLCAwKSxcbiAgICAnbncnOiBuZXcgY2g2X2V4XzEuVmVjdG9yKC0xLCAtMSlcbn07XG52YXIgcGxhbiA9IFsnIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIycsXG4gICAgJyMgICAgICAjICAgICMgICAgICBvICAgICAgIyMnLFxuICAgICcjICAgICAgICAgICAgICAgICAgICAgICAgICAjJyxcbiAgICAnIyAgICAgICAgICAjIyMjIyAgICAgICAgICAgIycsXG4gICAgJyMjICAgICAgICAgIyAgICMgICAgIyMgICAgICMnLFxuICAgICcjIyMgICAgICAgICAgICMjICAgICAjICAgICAjJyxcbiAgICAnIyAgICAgICAgICAgIyMjICAgICAgIyAgICAgIycsXG4gICAgJyMgICAjIyMjICAgICAgICAgICAgICAgICAgICMnLFxuICAgICcjICAgIyMgICAgICAgbyAgICAgICAgICAgICAjJyxcbiAgICAnIyBvICAjICAgICAgICAgbyAgICAgICAjIyMgIycsXG4gICAgJyMgICAgIyAgICAgICAgICAgICAgICAgICAgICMnLFxuICAgICcjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjJ107XG52YXIgZGlyZWN0aW9uTmFtZXMgPSAnbiBuZSBlIHNlIHMgc3cgdyBudycuc3BsaXQoJyAnKTtcbmZ1bmN0aW9uIHJhbmRvbUVsZW1lbnQoYXJyYXkpIHtcbiAgICByZXR1cm4gYXJyYXlbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYXJyYXkubGVuZ3RoKV07XG59XG52YXIgR3JpZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gR3JpZCh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuc3BhY2UgPSBuZXcgQXJyYXkod2lkdGggKiBoZWlnaHQpO1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cbiAgICBHcmlkLnByb3RvdHlwZS5pc0luc2lkZSA9IGZ1bmN0aW9uICh2ZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIHZlY3Rvci54ID49IDAgJiYgdmVjdG9yLnggPCB0aGlzLndpZHRoICYmXG4gICAgICAgICAgICB2ZWN0b3IueSA+PSAwICYmIHZlY3Rvci55IDwgdGhpcy5oZWlnaHQ7XG4gICAgfTtcbiAgICA7XG4gICAgR3JpZC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHZlY3Rvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5zcGFjZVt2ZWN0b3IueCArIHRoaXMud2lkdGggKiB2ZWN0b3IueV07XG4gICAgfTtcbiAgICA7XG4gICAgR3JpZC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHZlY3RvciwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5zcGFjZVt2ZWN0b3IueCArIHRoaXMud2lkdGggKiB2ZWN0b3IueV0gPSB2YWx1ZTtcbiAgICB9O1xuICAgIDtcbiAgICBHcmlkLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGYsIGNvbnRleHQpIHtcbiAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHRoaXMud2lkdGg7IHgrKykge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuc3BhY2VbeCArIHkgKiB0aGlzLndpZHRoXTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgZi5jYWxsKGNvbnRleHQsIHZhbHVlLCBuZXcgY2g2X2V4XzEuVmVjdG9yKHgsIHkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgO1xuICAgIHJldHVybiBHcmlkO1xufSgpKTtcbmZ1bmN0aW9uIGVsZW1lbnRGcm9tQ2hhcihsZWdlbmQsIGNoKSB7XG4gICAgaWYgKGNoID09ICcgJylcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgdmFyIGVsZW1lbnQgPSBuZXcgbGVnZW5kW2NoXSgpO1xuICAgIGVsZW1lbnQub3JpZ2luQ2hhciA9IGNoO1xuICAgIHJldHVybiBlbGVtZW50O1xufVxuZnVuY3Rpb24gY2hhckZyb21FbGVtZW50KGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudCA9PSBudWxsKVxuICAgICAgICByZXR1cm4gJyAnO1xuICAgIGVsc2VcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQub3JpZ2luQ2hhcjtcbn1cbmZ1bmN0aW9uIFdhbGwoKSB7IH1cbjtcbnZhciBCb3VuY2luZ0NyaXR0ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJvdW5jaW5nQ3JpdHRlcihkaXJlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSByYW5kb21FbGVtZW50KGRpcmVjdGlvbk5hbWVzKTtcbiAgICB9XG4gICAgQm91bmNpbmdDcml0dGVyLnByb3RvdHlwZS5hY3QgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICBpZiAodmlldy5sb29rKHRoaXMuZGlyZWN0aW9uKSAhPSAnICcpIHtcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gdmlldy5maW5kKCcgJykgfHwgJ3MnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHR5cGU6ICdtb3ZlJywgZGlyZWN0aW9uOiB0aGlzLmRpcmVjdGlvbiB9O1xuICAgIH07XG4gICAgcmV0dXJuIEJvdW5jaW5nQ3JpdHRlcjtcbn0oKSk7XG52YXIgV29ybGQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFdvcmxkKG1hcCwgbGVnZW5kKSB7XG4gICAgICAgIHZhciBncmlkID0gbmV3IEdyaWQobWFwWzBdLmxlbmd0aCwgbWFwLmxlbmd0aCk7XG4gICAgICAgIHRoaXMuZ3JpZCA9IGdyaWQ7XG4gICAgICAgIHRoaXMubGVnZW5kID0gbGVnZW5kO1xuICAgICAgICB0aGlzLm1hcCA9IG1hcC5mb3JFYWNoKGZ1bmN0aW9uIChsaW5lLCB5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGxpbmUubGVuZ3RoOyB4KyspXG4gICAgICAgICAgICAgICAgZ3JpZC5zZXQobmV3IGNoNl9leF8xLlZlY3Rvcih4LCB5KSwgZWxlbWVudEZyb21DaGFyKGxlZ2VuZCwgbGluZVt4XSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgO1xuICAgIFdvcmxkLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG91dHB1dCA9ICcnO1xuICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IHRoaXMuZ3JpZC5oZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB0aGlzLmdyaWQud2lkdGg7IHgrKykge1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5ncmlkLmdldChuZXcgY2g2X2V4XzEuVmVjdG9yKHgsIHkpKTtcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0gY2hhckZyb21FbGVtZW50KGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0ICs9ICdcXG4nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgICA7XG4gICAgV29ybGQucHJvdG90eXBlLnR1cm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhY3RlZCA9IFtdO1xuICAgICAgICB0aGlzLmdyaWQuZm9yRWFjaChmdW5jdGlvbiAoY3JpdHRlciwgdmVjdG9yKSB7XG4gICAgICAgICAgICBpZiAoY3JpdHRlci5hY3QgJiYgYWN0ZWQuaW5kZXhPZihjcml0dGVyKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgIGFjdGVkLnB1c2goY3JpdHRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5sZXRBY3QoY3JpdHRlciwgdmVjdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfTtcbiAgICA7XG4gICAgV29ybGQucHJvdG90eXBlLmxldEFjdCA9IGZ1bmN0aW9uIChjcml0dGVyLCB2ZWN0b3IpIHtcbiAgICAgICAgdmFyIGFjdGlvbiA9IGNyaXR0ZXIuYWN0KG5ldyBWaWV3KHRoaXMsIHZlY3RvcikpO1xuICAgICAgICBpZiAoYWN0aW9uICYmIGFjdGlvbi50eXBlID09ICdtb3ZlJykge1xuICAgICAgICAgICAgdmFyIGRlc3QgPSB0aGlzLmNoZWNrRGVzdGluYXRpb24oYWN0aW9uLCB2ZWN0b3IpO1xuICAgICAgICAgICAgaWYgKGRlc3QgJiYgdGhpcy5ncmlkLmdldChkZXN0KSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmlkLnNldCh2ZWN0b3IsIG51bGwpO1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZC5zZXQoZGVzdCwgY3JpdHRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIDtcbiAgICBXb3JsZC5wcm90b3R5cGUuY2hlY2tEZXN0aW5hdGlvbiA9IGZ1bmN0aW9uIChhY3Rpb24sIHZlY3Rvcikge1xuICAgICAgICBpZiAoZGlyZWN0aW9ucy5oYXNPd25Qcm9wZXJ0eShhY3Rpb24uZGlyZWN0aW9uKSkge1xuICAgICAgICAgICAgdmFyIGRlc3QgPSB2ZWN0b3IucGx1cyhkaXJlY3Rpb25zW2FjdGlvbi5kaXJlY3Rpb25dKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdyaWQuaXNJbnNpZGUoZGVzdCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlc3Q7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIDtcbiAgICByZXR1cm4gV29ybGQ7XG59KCkpO1xudmFyIFZpZXcgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFZpZXcod29ybGQsIHZlY3Rvcikge1xuICAgICAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgICAgIHRoaXMudmVjdG9yID0gdmVjdG9yO1xuICAgIH1cbiAgICBWaWV3LnByb3RvdHlwZS5sb29rID0gZnVuY3Rpb24gKGRpcikge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy52ZWN0b3IucGx1cyhkaXJlY3Rpb25zW2Rpcl0pO1xuICAgICAgICBpZiAodGhpcy53b3JsZC5ncmlkLmlzSW5zaWRlKHRhcmdldCkpXG4gICAgICAgICAgICByZXR1cm4gY2hhckZyb21FbGVtZW50KHRoaXMud29ybGQuZ3JpZC5nZXQodGFyZ2V0KSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiAnIyc7XG4gICAgfTtcbiAgICA7XG4gICAgVmlldy5wcm90b3R5cGUuZmluZEFsbCA9IGZ1bmN0aW9uIChjaCkge1xuICAgICAgICB2YXIgZm91bmQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgZGlyIGluIGRpcmVjdGlvbnMpXG4gICAgICAgICAgICBpZiAodGhpcy5sb29rKGRpcikgPT0gY2gpXG4gICAgICAgICAgICAgICAgZm91bmQucHVzaChkaXIpO1xuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfTtcbiAgICA7XG4gICAgVmlldy5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uIChjaCkge1xuICAgICAgICB2YXIgZm91bmQgPSB0aGlzLmZpbmRBbGwoY2gpO1xuICAgICAgICBpZiAoZm91bmQubGVuZ3RoID09IDApXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIHJhbmRvbUVsZW1lbnQoZm91bmQpO1xuICAgIH07XG4gICAgO1xuICAgIHJldHVybiBWaWV3O1xufSgpKTtcbmZ1bmN0aW9uIGRpclBsdXMoZGlyLCBuKSB7XG4gICAgdmFyIGluZGV4ID0gZGlyZWN0aW9uTmFtZXMuaW5kZXhPZihkaXIpO1xuICAgIHJldHVybiBkaXJlY3Rpb25OYW1lc1soaW5kZXggKyBuICsgOCkgJSA4XTtcbn1cbnZhciBXYWxsRmxvd2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBXYWxsRmxvd2VyKGRpcikge1xuICAgICAgICB0aGlzLmRpciA9ICdzJztcbiAgICB9XG4gICAgO1xuICAgIFdhbGxGbG93ZXIucHJvdG90eXBlLmFjdCA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMuZGlyO1xuICAgICAgICBpZiAodmlldy5sb29rKGRpclBsdXModGhpcy5kaXIsIC0zKSkgIT0gJyAnKVxuICAgICAgICAgICAgc3RhcnQgPSB0aGlzLmRpciA9IGRpclBsdXModGhpcy5kaXIsIC0yKTtcbiAgICAgICAgd2hpbGUgKHZpZXcubG9vayh0aGlzLmRpcikgIT0gJyAnKSB7XG4gICAgICAgICAgICB0aGlzLmRpciA9IGRpclBsdXModGhpcy5kaXIsIDEpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGlyID09IHN0YXJ0KVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHR5cGU6ICdtb3ZlJywgZGlyZWN0aW9uOiB0aGlzLmRpciB9O1xuICAgIH07XG4gICAgO1xuICAgIHJldHVybiBXYWxsRmxvd2VyO1xufSgpKTtcbnZhciBMaWZlbGlrZVdvcmxkID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlmZWxpa2VXb3JsZCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaWZlbGlrZVdvcmxkKG1hcCwgbGVnZW5kKSB7XG4gICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIG1hcCwgbGVnZW5kKTtcbiAgICAgICAgV29ybGQuY2FsbCh0aGlzLCBtYXAsIGxlZ2VuZCk7XG4gICAgICAgIE9iamVjdC5jcmVhdGUoV29ybGQpO1xuICAgIH1cbiAgICBMaWZlbGlrZVdvcmxkLnByb3RvdHlwZS5sZXRBY3QgPSBmdW5jdGlvbiAoY3JpdHRlciwgdmVjdG9yKSB7XG4gICAgICAgIHZhciBhY3Rpb24gPSBjcml0dGVyLmFjdChuZXcgVmlldyh0aGlzLCB2ZWN0b3IpKTtcbiAgICAgICAgdmFyIGhhbmRsZWQgPSBhY3Rpb24gJiZcbiAgICAgICAgICAgIGFjdGlvbi50eXBlIGluIGFjdGlvblR5cGVzICYmXG4gICAgICAgICAgICBhY3Rpb25UeXBlc1thY3Rpb24udHlwZV0uY2FsbCh0aGlzLCBjcml0dGVyLCB2ZWN0b3IsIGFjdGlvbik7XG4gICAgICAgIGlmICghaGFuZGxlZCkge1xuICAgICAgICAgICAgY3JpdHRlci5lbmVyZ3kgLT0gMC4yO1xuICAgICAgICAgICAgaWYgKGNyaXR0ZXIuZW5lcmd5IDw9IDApXG4gICAgICAgICAgICAgICAgdGhpcy5ncmlkLnNldCh2ZWN0b3IsIG51bGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICA7XG4gICAgcmV0dXJuIExpZmVsaWtlV29ybGQ7XG59KFdvcmxkKSk7XG52YXIgYWN0aW9uVHlwZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuYWN0aW9uVHlwZXMuZ3JvdyA9IGZ1bmN0aW9uIChjcml0dGVyKSB7XG4gICAgY3JpdHRlci5lbmVyZ3kgKz0gMC41O1xuICAgIHJldHVybiB0cnVlO1xufTtcbmFjdGlvblR5cGVzLm1vdmUgPSBmdW5jdGlvbiAoY3JpdHRlciwgdmVjdG9yLCBhY3Rpb24pIHtcbiAgICB2YXIgZGVzdCA9IHRoaXMuY2hlY2tEZXN0aW5hdGlvbihhY3Rpb24sIHZlY3Rvcik7XG4gICAgaWYgKGRlc3QgPT0gbnVsbCB8fCBjcml0dGVyLmVuZXJneSA8PSAxIHx8IHRoaXMuZ3JpZC5nZXQoZGVzdCkgIT0gbnVsbClcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGNyaXR0ZXIuZW5lcmd5IC09IDE7XG4gICAgdGhpcy5ncmlkLnNldCh2ZWN0b3IsIG51bGwpO1xuICAgIHRoaXMuZ3JpZC5zZXQoZGVzdCwgY3JpdHRlcik7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuYWN0aW9uVHlwZXMuZWF0ID0gZnVuY3Rpb24gKGNyaXR0ZXIsIHZlY3RvciwgYWN0aW9uKSB7XG4gICAgdmFyIGRlc3QgPSB0aGlzLmNoZWNrRGVzdGluYXRpb24oYWN0aW9uLCB2ZWN0b3IpO1xuICAgIHZhciBhdERlc3QgPSBkZXN0ICE9IG51bGwgJiYgdGhpcy5ncmlkLmdldChkZXN0KTtcbiAgICBpZiAoIWF0RGVzdCB8fCBhdERlc3QuZW5lcmd5ID09IG51bGwpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBjcml0dGVyLmVuZXJneSArPSBhdERlc3QuZW5lcmd5O1xuICAgIHRoaXMuZ3JpZC5zZXQoZGVzdCwgbnVsbCk7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuYWN0aW9uVHlwZXMucmVwcm9kdWNlID0gZnVuY3Rpb24gKGNyaXR0ZXIsIHZlY3RvciwgYWN0aW9uKSB7XG4gICAgdmFyIGJhYnkgPSBlbGVtZW50RnJvbUNoYXIodGhpcy5sZWdlbmQsIGNyaXR0ZXIub3JpZ2luQ2hhcik7XG4gICAgdmFyIGRlc3QgPSB0aGlzLmNoZWNrRGVzdGluYXRpb24oYWN0aW9uLCB2ZWN0b3IpO1xuICAgIGlmIChkZXN0ID09IG51bGwgfHwgY3JpdHRlci5lbmVyZ3kgPD0gMiAqIGJhYnkuZW5lcmd5IHx8IHRoaXMuZ3JpZC5nZXQoZGVzdCkgIT0gbnVsbClcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGNyaXR0ZXIuZW5lcmd5IC09IDIgKiBiYWJ5LmVuZXJneTtcbiAgICB0aGlzLmdyaWQuc2V0KGRlc3QsIGJhYnkpO1xuICAgIHJldHVybiB0cnVlO1xufTtcbnZhciBQbGFudCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGxhbnQoZW5lcmd5KSB7XG4gICAgICAgIHRoaXMuZW5lcmd5ID0gMyArIE1hdGgucmFuZG9tKCkgKiA0O1xuICAgIH1cbiAgICBQbGFudC5wcm90b3R5cGUuYWN0ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5lcmd5ID4gMTUpIHtcbiAgICAgICAgICAgIHZhciBzcGFjZSA9IHZpZXcuZmluZCgnICcpO1xuICAgICAgICAgICAgaWYgKHNwYWNlKVxuICAgICAgICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdyZXByb2R1Y2UnLCBkaXJlY3Rpb246IHNwYWNlIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZW5lcmd5IDwgMjApXG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiAnZ3JvdycsIGRpcmVjdGlvbjogdW5kZWZpbmVkIH07XG4gICAgfTtcbiAgICA7XG4gICAgcmV0dXJuIFBsYW50O1xufSgpKTtcbnZhciBQbGFudEVhdGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQbGFudEVhdGVyKGVuZXJneSkge1xuICAgICAgICB0aGlzLmVuZXJneSA9IDIwO1xuICAgIH1cbiAgICBQbGFudEVhdGVyLnByb3RvdHlwZS5hY3QgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgc3BhY2UgPSB2aWV3LmZpbmQoJyAnKTtcbiAgICAgICAgaWYgKHRoaXMuZW5lcmd5ID4gNjAgJiYgc3BhY2UpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdyZXByb2R1Y2UnLCBkaXJlY3Rpb246IHNwYWNlIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBsYW50ID0gdmlldy5maW5kKCcqJyk7XG4gICAgICAgIGlmIChwbGFudCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogJ2VhdCcsIGRpcmVjdGlvbjogcGxhbnQgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3BhY2UpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdtb3ZlJywgZGlyZWN0aW9uOiBzcGFjZSB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICA7XG4gICAgcmV0dXJuIFBsYW50RWF0ZXI7XG59KCkpO1xuLy8gdmFyIHZhbGxleSA9IG5ldyBMaWZlbGlrZVdvcmxkKFxuLy8gICBbJyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMnLFxuLy8gICAgJyMjIyMjICAgICAgICAgICAgICAgICAjIyMjIyMnLFxuLy8gICAgJyMjICAgKioqICAgICAgICAgICAgICAgICoqIyMnLFxuLy8gICAgJyMgICAqIyMqKiAgICAgICAgICoqICBPICAqIyMnLFxuLy8gICAgJyMgICAgKioqICAgICBPICAgICMjKiogICAgKiMnLFxuLy8gICAgJyMgICAgICAgTyAgICAgICAgICMjKioqICAgICMnLFxuLy8gICAgJyMgICAgICAgICAgICAgICAgICMjKiogICAgICMnLFxuLy8gICAgJyMgICBPICAgICAgICMqICAgICAgICAgICAgICMnLFxuLy8gICAgJyMqICAgICAgICAgICMqKiAgICAgICBPICAgICMnLFxuLy8gICAgJyMqKiogICAgICAgICMjKiogICAgTyAgICAqKiMnLFxuLy8gICAgJyMjKioqKiAgICAgIyMjKioqICAgICAgICojIyMnLFxuLy8gICAgJyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMnXSxcbi8vICAgeycjJzogV2FsbCxcbi8vICAgICdPJzogUGxhbnRFYXRlcixcbi8vICAgICcqJzogUGxhbnR9XG4vLyApO1xuLy8gYW5pbWF0ZVdvcmxkKHZhbGxleSk7XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy9Qcm9ibGVtIDFcbnZhciBTbWFydFBsYW50RWF0ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNtYXJ0UGxhbnRFYXRlcihlbmVyZ3ksIGRpcikge1xuICAgICAgICB0aGlzLmVuZXJneSA9IDIwO1xuICAgICAgICB0aGlzLmRpciA9IHJhbmRvbUVsZW1lbnQoZGlyZWN0aW9uTmFtZXMpO1xuICAgIH1cbiAgICBTbWFydFBsYW50RWF0ZXIucHJvdG90eXBlLmFjdCA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHZhciBzcGFjZSA9IHZpZXcuZmluZCgnICcpO1xuICAgICAgICB2YXIgcGxhbnRzID0gdmlldy5maW5kQWxsKCcqJyk7XG4gICAgICAgIGlmICh0aGlzLmVuZXJneSA+IDk1ICYmIHNwYWNlKVxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogJ3JlcHJvZHVjZScsIGRpcmVjdGlvbjogc3BhY2UgfTtcbiAgICAgICAgaWYgKHBsYW50cy5sZW5ndGggPiAxKVxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogJ2VhdCcsIGRpcmVjdGlvbjogcmFuZG9tRWxlbWVudChwbGFudHMpIH07XG4gICAgICAgIGlmICh2aWV3Lmxvb2sodGhpcy5kaXIpICE9ICcgJyAmJiBzcGFjZSlcbiAgICAgICAgICAgIHRoaXMuZGlyID0gc3BhY2U7XG4gICAgICAgIHJldHVybiB7IHR5cGU6ICdtb3ZlJywgZGlyZWN0aW9uOiB0aGlzLmRpciB9O1xuICAgIH07XG4gICAgO1xuICAgIHJldHVybiBTbWFydFBsYW50RWF0ZXI7XG59KCkpO1xuLy8gYW5pbWF0ZVdvcmxkKG5ldyBMaWZlbGlrZVdvcmxkKFxuLy8gICBbJyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMnLFxuLy8gICAgJyMjIyMjICAgICAgICAgICAgICAgICAjIyMjIyMnLFxuLy8gICAgJyMjICAgKioqICAgICAgICAgICAgICAgICoqIyMnLFxuLy8gICAgJyMgICAqIyMqKiAgICAgICAgICoqICBPICAqIyMnLFxuLy8gICAgJyMgICAgKioqICAgICBPICAgICMjKiogICAgKiMnLFxuLy8gICAgJyMgICAgICAgTyAgICAgICAgICMjKioqICAgICMnLFxuLy8gICAgJyMgICAgICAgICAgICAgICAgICMjKiogICAgICMnLFxuLy8gICAgJyMgICBPICAgICAgICMqICAgICAgICAgICAgICMnLFxuLy8gICAgJyMqICAgICAgICAgICMqKiAgICAgICBPICAgICMnLFxuLy8gICAgJyMqKiogICAgICAgICMjKiogICAgTyAgICAqKiMnLFxuLy8gICAgJyMjKioqKiAgICAgIyMjKioqICAgICAgICojIyMnLFxuLy8gICAgJyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMnXSxcbi8vICAgeycjJzogV2FsbCxcbi8vICAgICdPJzogU21hcnRQbGFudEVhdGVyLFxuLy8gICAgJyonOiBQbGFudH1cbi8vICkpO1xuLy9QUk9CTEVNIDJcbmFjdGlvblR5cGVzLnN0YXkgPSBmdW5jdGlvbiAoY3JpdHRlciwgdmVjdG9yLCBhY3Rpb24pIHtcbiAgICByZXR1cm4gZmFsc2U7XG59O1xudmFyIFRpZ2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUaWdlcihlbmVyZ3ksIGRpciwgbWVtb3J5KSB7XG4gICAgICAgIHRoaXMuZW5lcmd5ID0gOTA7XG4gICAgICAgIHRoaXMuZGlyID0gcmFuZG9tRWxlbWVudChkaXJlY3Rpb25OYW1lcyk7XG4gICAgICAgIHRoaXMubWVtb3J5ID0gW107IC8vaG9sZHMgY291bnQgb2YgbnVtYmVyIG9mIHByZXkgYXJvdW5kIHByZWRhdG9yIGVhY2ggdHVybi5cbiAgICB9XG4gICAgVGlnZXIucHJvdG90eXBlLmFjdCA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHZhciBzZWVuRWFjaFR1cm4gPSB0aGlzLm1lbW9yeS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgKyBiOyB9LCAwKSAvIHRoaXMubWVtb3J5Lmxlbmd0aDtcbiAgICAgICAgdmFyIHByZXkgPSB2aWV3LmZpbmRBbGwoJ08nKTtcbiAgICAgICAgdmFyIHNwYWNlID0gdmlldy5maW5kKCcgJyk7XG4gICAgICAgIHRoaXMubWVtb3J5LnB1c2gocHJleS5sZW5ndGgpO1xuICAgICAgICBpZiAodGhpcy5tZW1vcnkubGVuZ3RoID4gNSlcbiAgICAgICAgICAgIHRoaXMubWVtb3J5LnNoaWZ0KCk7XG4gICAgICAgIGlmIChwcmV5Lmxlbmd0aCAmJiBzZWVuRWFjaFR1cm4gPiAwLjMzKVxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogJ2VhdCcsIGRpcmVjdGlvbjogcmFuZG9tRWxlbWVudChwcmV5KSB9O1xuICAgICAgICBpZiAoc2VlbkVhY2hUdXJuIDwgMC4xMClcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdzdGF5JywgZGlyZWN0aW9uOiB1bmRlZmluZWQgfTtcbiAgICAgICAgaWYgKHRoaXMuZW5lcmd5ID4gMzAwICYmIHNwYWNlKVxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogJ3JlcHJvZHVjZScsIGRpcmVjdGlvbjogc3BhY2UgfTtcbiAgICAgICAgaWYgKHZpZXcubG9vayh0aGlzLmRpcikgIT0gJyAnICYmIHNwYWNlKVxuICAgICAgICAgICAgdGhpcy5kaXIgPSBzcGFjZTtcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogJ21vdmUnLCBkaXJlY3Rpb246IHRoaXMuZGlyIH07XG4gICAgfTtcbiAgICA7XG4gICAgcmV0dXJuIFRpZ2VyO1xufSgpKTtcbmFuaW1hdGVXb3JsZChuZXcgTGlmZWxpa2VXb3JsZChbJyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMnLFxuICAgICcjICAgICAgICAgICAgICAgICAjIyMjICAgICAgICAgKioqKiAgICAgICAgICAgICAgIyMjJyxcbiAgICAnIyAgICogIEAgICMjICAgICAgICAgICAgICAgICAjIyMjIyMjIyAgICAgICBPTyAgICAjIycsXG4gICAgJyMgICAqICAgICMjICAgICAgICBPIE8gICAgICAgICAgICAgICAgICoqKiogICAgICAgKiMnLFxuICAgICcjICAgICAgICMjKiAgICAgICAgICAgICAgICAgICAgICAgICMjIyMjIyMjIyMgICAgICojJyxcbiAgICAnIyAgICAgICMjKioqICAqICAgICAgICAgKioqKiAgICAgICAgICAgICAgICAgICAgICoqIycsXG4gICAgJyMqICoqICAjICAqICAqKiogICAgICAjIyMjIyMjIyMgICAgICAgICAgICAgICAgICAqKiMnLFxuICAgICcjKiAqKiAgIyAgICAgICogICAgICAgICAgICAgICAjICAgKiAgICAgICAgICAgICAgKiojJyxcbiAgICAnIyAgICAgIyMgICAgICAgICAgICAgICMgICBPICAgIyAgKioqICAgICAgICAgICMjIyMjIycsXG4gICAgJyMqICAgICAgICAgICAgQCAgICAgICAjICAgICAgICMgICAqICAgICAgICBPICAjICAgICMnLFxuICAgICcjKiAgICAgICAgICAgICAgICAgICAgIyAgIyMjIyMjICAgICAgICAgICAgICAgICAqKiAjJyxcbiAgICAnIyMjICAgICAgICAgICoqKiogICAgICAgICAgKioqICAgICAgICAgICAgICAgICAgKiogIycsXG4gICAgJyMgICAgICAgTyAgICAgICAgICAgICAgICAgICAgICAgIEAgICAgICAgICBPICAgICAgICMnLFxuICAgICcjICAgKiAgICAgIyMgICMjICAjIyAgIyMgICAgICAgICAgICAgICAjIyMgICAgICAqICAjJyxcbiAgICAnIyAgICoqICAgICAgICAgIyAgICAgICAgICAgICAgKiAgICAgICAjIyMjIyAgTyAgICAgIycsXG4gICAgJyMjICAqKiAgTyAgIE8gICMgICMgICAgKioqICAqKiogICAgICAgICMjIyAgICAgICoqICMnLFxuICAgICcjIyMgICAgICAgICAgICAgICAjICAgKioqKiogICAgICAgICAgICAgICAgICAgICoqKiojJyxcbiAgICAnIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyddLCB7ICcjJzogV2FsbCxcbiAgICAnQCc6IFRpZ2VyLFxuICAgICdPJzogU21hcnRQbGFudEVhdGVyLFxuICAgICcqJzogUGxhbnQgfSkpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY2g3L2NoNy1wcm9qLmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbn07XG4vL1BST0JMRU0gMSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xudmFyIFZlY3RvciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVmVjdG9yKHgsIHkpIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICB9XG4gICAgVmVjdG9yLnByb3RvdHlwZS5wbHVzID0gZnVuY3Rpb24gKGFsdCkge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3Rvcih0aGlzLnggKyBhbHQueCwgdGhpcy55ICsgYWx0LnkpO1xuICAgIH07XG4gICAgVmVjdG9yLnByb3RvdHlwZS5taW51cyA9IGZ1bmN0aW9uIChhbHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IodGhpcy54IC0gYWx0LngsIHRoaXMueSAtIGFsdC55KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWZWN0b3IucHJvdG90eXBlLCBcImxlbmd0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguc3FydCgodGhpcy54ICogdGhpcy54KSArICh0aGlzLnkgKiB0aGlzLnkpKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFZlY3Rvcjtcbn0oKSk7XG5leHBvcnRzLlZlY3RvciA9IFZlY3Rvcjtcbi8vY29uc29sZS5sb2cobmV3IFZlY3RvcigxLCAyKS5wbHVzKG5ldyBWZWN0b3IoMiwgMykpKTtcbi8vIOKGkiBWZWN0b3J7eDogMywgeTogNX1cbi8vY29uc29sZS5sb2cobmV3IFZlY3RvcigxLCAyKS5taW51cyhuZXcgVmVjdG9yKDIsIDMpKSk7XG4vLyDihpIgVmVjdG9ye3g6IC0xLCB5OiAtMX1cbi8vY29uc29sZS5sb2cobmV3IFZlY3RvcigzLCA0KS5sZW5ndGgpO1xuLy8g4oaSIDVcbi8vUFJPQkxFTSAyIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vL2Zyb20gdGV4dGJvb2suXG5mdW5jdGlvbiByZXBlYXQoc3RyaW5nLCB0aW1lcykge1xuICAgIHZhciByZXN1bHQgPSAnJztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRpbWVzOyBpKyspXG4gICAgICAgIHJlc3VsdCArPSBzdHJpbmc7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbi8vaW5mZXJyZWQgZnJvbSB0ZXh0Ym9vay5cbi8vbWluV2lkdGggYW5kIG1pbkhlaWdodCBtZXRob2RzIGhhdmUgYmVlbiBhbHRlcmVkIGZyb20gb3JpZ2luYWwgY29kZS5cbnZhciBUZXh0Q2VsbCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVGV4dENlbGwodGV4dCkge1xuICAgICAgICB0aGlzLnRleHQgPSB0ZXh0LnNwbGl0KCcnKTtcbiAgICB9XG4gICAgVGV4dENlbGwucHJvdG90eXBlLm1pbldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0Lmxlbmd0aDtcbiAgICB9O1xuICAgIFRleHRDZWxsLnByb3RvdHlwZS5taW5IZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH07XG4gICAgVGV4dENlbGwucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGVpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgIHZhciBsaW5lID0gdGhpcy50ZXh0W2ldIHx8ICcnO1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gobGluZSArIHJlcGVhdCgnICcsIHdpZHRoIC0gbGluZS5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIFRleHRDZWxsO1xufSgpKTtcbnZhciBTdHJldGNoQ2VsbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN0cmV0Y2hDZWxsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN0cmV0Y2hDZWxsKHRleHQsIHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgdGV4dCk7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgfVxuICAgIFN0cmV0Y2hDZWxsLnByb3RvdHlwZS5taW5XaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KHRoaXMud2lkdGgsIF9zdXBlci5wcm90b3R5cGUubWluV2lkdGguY2FsbCh0aGlzKSk7XG4gICAgfTtcbiAgICBTdHJldGNoQ2VsbC5wcm90b3R5cGUubWluSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5oZWlnaHQsIF9zdXBlci5wcm90b3R5cGUubWluSGVpZ2h0LmNhbGwodGhpcykpO1xuICAgIH07XG4gICAgU3RyZXRjaENlbGwucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5kcmF3LmNhbGwodGhpcywgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIH07XG4gICAgcmV0dXJuIFN0cmV0Y2hDZWxsO1xufShUZXh0Q2VsbCkpO1xudmFyIHNjID0gbmV3IFN0cmV0Y2hDZWxsKCdhYmMnLCAxLCAyKTtcbi8vY29uc29sZS5sb2coc2MubWluV2lkdGgoKSk7XG4vLyDihpIgM1xuLy9jb25zb2xlLmxvZyhzYy5taW5IZWlnaHQoKSk7XG4vLyDihpIgMlxuLy9jb25zb2xlLmxvZyhzYy5kcmF3KDMsIDIpKTtcbi8vIGRyYXcgbWV0aG9kIGluaGVyaXRlZCBmcm9tIHRleHQuIE91dHB1dCBkb2Vzbid0IHBhc3MgdGVzdC4gwq9cXF8o44OEKV8vwq8gXG4vLyDihpIgWydhYmMnLCAnICAgJ11cbi8vUFJPQkxFTSAzIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5mdW5jdGlvbiBsb2dGaXZlKHNlcSkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgIGlmICghc2VxLm5leHQoKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coc2VxLmN1cnJlbnQoKSk7XG4gICAgfVxufVxudmFyIEFycmF5U2VxID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBcnJheVNlcShhcnJheSkge1xuICAgICAgICB0aGlzLnBvcyA9IC0xO1xuICAgICAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG4gICAgfVxuICAgIEFycmF5U2VxLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wb3MgPj0gdGhpcy5hcnJheS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3MrKztcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBBcnJheVNlcS5wcm90b3R5cGUuY3VycmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXJyYXlbdGhpcy5wb3NdO1xuICAgIH07XG4gICAgcmV0dXJuIEFycmF5U2VxO1xufSgpKTtcbi8vdXNpbmcgc3RhcnQgYW5kIGVuZCBpbnN0ZWFkIG9mIGZyb20gYW5kIHRvIGFyZ3VtZW50cy5cbnZhciBSYW5nZVNlcSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmFuZ2VTZXEoc3RhcnQsIGVuZCkge1xuICAgICAgICB0aGlzLnBvcyA9IHN0YXJ0IC0gMTtcbiAgICAgICAgdGhpcy5lbmQgPSBlbmQ7XG4gICAgfVxuICAgIFJhbmdlU2VxLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5wb3MgPj0gdGhpcy5lbmQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBvcysrO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFJhbmdlU2VxLnByb3RvdHlwZS5jdXJyZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3M7XG4gICAgfTtcbiAgICByZXR1cm4gUmFuZ2VTZXE7XG59KCkpO1xuLy9sb2dGaXZlKG5ldyBBcnJheVNlcShbMSwgMl0pKTtcbi8vIOKGkiAxXG4vLyDihpIgMlxuLy9sb2dGaXZlKG5ldyBSYW5nZVNlcSgxMDAsIDEwMDApKTtcbi8vIOKGkiAxMDBcbi8vIOKGkiAxMDFcbi8vIOKGkiAxMDJcbi8vIOKGkiAxMDNcbi8vIOKGkiAxMDRcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2NoNi9jaDYtZXguanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==